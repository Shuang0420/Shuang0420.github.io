<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />













  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="NLP," />





  <link rel="alternate" href="/atom.xml" title="徐阿衡" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.3" />






<meta name="description" content="关于如何从给定文本中产生合适的问句。–持续更新中–">
<meta property="og:type" content="article">
<meta property="og:title" content="QA system - Question Generation">
<meta property="og:url" content="http://www.shuang0420.cn/2017/04/06/QA system - Question Generation/index.html">
<meta property="og:site_name" content="徐阿衡">
<meta property="og:description" content="关于如何从给定文本中产生合适的问句。–持续更新中–">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/1.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/2.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/0.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/3.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/4.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/5.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/6.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/7.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/8.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/9.jpg">
<meta property="og:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/10.jpg">
<meta property="og:updated_time" content="2020-09-10T12:26:31.622Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="QA system - Question Generation">
<meta name="twitter:description" content="关于如何从给定文本中产生合适的问句。–持续更新中–">
<meta name="twitter:image" content="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/1.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '6294135991397516000',
      author: '阿衡'
    }
  };
</script>

<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6146435155426457",
    enable_page_level_ads: true
  });
</script>




  <link rel="canonical" href="http://www.shuang0420.cn/2017/04/06/QA system - Question Generation/"/>


  <title> QA system - Question Generation | 徐阿衡 </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="en">

  










  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">徐阿衡</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Shuang</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-works">
          <a href="/works" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Works
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/aboutme" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input" placeholder="search my blog...">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
         
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                QA system - Question Generation
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2017-04-06T11:00:00+08:00" content="2017-04-06">
              2017-04-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/NLP/" itemprop="url" rel="index">
                    <span itemprop="name">NLP</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/NLP/Chatbot/" itemprop="url" rel="index">
                    <span itemprop="name">Chatbot</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/04/06/QA system - Question Generation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/04/06/QA system - Question Generation/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
              &nbsp; | &nbsp;
              <span class="page-pv"><i class="fa fa-file-o"></i>
              <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
              </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>关于如何从给定文本中产生合适的问句。–持续更新中–<br><a id="more"></a></p>
<p>做了一段时间的 Asking System，尝试了各种包，也踩了很多的坑，从全无头绪到现在小有心得，中间经历了很多，这里做一些记录。</p>
<p>总的思路是找出简单的陈述句，然后对其进行变形(如下)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">X is Y =&gt; Is X Y?  /   What is Y? (what/why/who/when)</div><div class="line">The X verbs Y =&gt; Does X verb Y  /  What does the X verb?</div></pre></td></tr></table></figure>
<p>第一大问题是怎么找候选陈述句，过于复杂的句子我们需要进行简化，我们要找的句型是 S &lt; (NP $.. VP)，然而就是这样的 NP VP 下接的诸多介词短语或从句也够我们烦恼的了，定义更加限制性的规则还是很有必要的。另外非常适合用来产生问题的句子结构还有 <strong>同位语结构</strong>，<strong>动词修饰名词结构</strong>等等，下文会提到。</p>
<p>找出的这些候选陈述句应当提前做好 <strong>指代消解</strong>，方便进一步处理。</p>
<p>无论是对一般疑问句还是特殊疑问句，关键的都是找 <strong>谓词(predicate)</strong>。</p>
<p>对于一般疑问句而言，如果 predicate 是 auxiliary verb 或者 modal，比如 is, was, are, did, have, etc.，那么直接将 predicate 提前，其余部分按原顺序拼接，而 predicate 不是 auxiliary verb 也不是 modal，那么可能需要将动词还原成 do+动词原形的形式，然后将助动词提前，其余照抄(此时句子中的动词已经还原)。</p>
<p>而对特殊疑问句而言，需要利用 NER 来确定对哪个词进行提问以及用哪种疑问词，NER 的质量在这种场景下显得尤其重要。在实践过程中发现部分的 NER 对时间和地点的识别能力不是很强，这时候可能需要人工规则来进行补充，比如给介词短语添加限制来确定地点等。特殊疑问句另一个问题是一些不可能作为 answer phrase 的词，在下文的 Marking Unmovable Phrases 中也会提到，最为简单粗暴的方法是在 what/who 的问句中只对直接宾语来进行提问。</p>
<p>最后，关于问句的泛化，可以利用 WordNet 来替换一些关键词。</p>
<p>顺便提一下句子类型，在论文里经常会出现 declarative sentence 这类专有名词，这里稍稍解释翻译下。</p>
<ul>
<li>Declarative Sentences<br>  陈述句，陈述一个事实，以句号结尾，是最常见的类型<br>  e.g. There are five million people at risk.</li>
<li>Imperative Sentence<br>  祈使句，以感叹号或者句号结尾<br>  e.g. Fetch my umbrella!/Please bring my umbrella.</li>
<li>Interrogative Sentence<br>  疑问句，以问号结尾<br>  e.g. Can you find my umbrella?</li>
<li>Exclamatory Sentence<br>  感叹句，表达兴奋或者其他情感，感叹号结尾<br>  e.g. You’ve broken my umbrella!</li>
</ul>
<p>在 QG 系统中，我们需要的是 Declarative Sentences</p>
<h1 id="QG-Framework"><a href="#QG-Framework" class="headerlink" title="QG Framework"></a>QG Framework</h1><p>问句如何产生？一般是从文章中提取出合适的可以产生问句的 candidate，然后对其进行变形来得到。很多有用的问题可以被看做是把一个陈述句通过 <strong>词汇(lexical)、句法(syntactic)、语义(semantic)</strong> 层面的转化得到的。因此，在产生问句的阶段，我们需要把原有的句子转化为陈述句。</p>
<p>看一下 question generation 的框架。<br><img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/1.jpg" class="ful-image" alt="1.jpg"></p>
<p><strong>Stage 1</strong>，通过改变词汇来将原有语句转化为陈述句。有些句子很复杂，有些句子我们只需要某些成分，所以可以通过一些方法将原有的句子化简，形成能够产生问句的陈述句。在这个阶段，很多 NLP transformation 的方法都会被用到，包括 extractive summarization, sentence compression, sentence splitting, sentence fusion, paraphrase, textual entailment, lexical semantics for word substitution 等。</p>
<p><strong>Stage 2</strong>，通过进行一些句法层面的转化(如 WH-movement, subject-auxiliary inversion 等)将陈述句转换为问句，这个模块又叫 question transducer。</p>
<p><strong>Stage 3</strong>，对上一阶段产生的问题进行排序，特征可以是 source sentence, input sentences, question, transformation 各部分的特征集合。</p>
<p>明确一些概念：</p>
<ul>
<li>source sentence<br>  输入文档中的原始句子</li>
<li>input sentence<br>  question transducer 的输入，可能是原始句子也可能是经过转化的陈述句</li>
<li>answer phrase<br>  陈述句里可能被作为问句成分的目标词(targets for WH-movement)</li>
<li>question phrase<br>  替代 answer phrase 的疑问词</li>
</ul>
<h2 id="Stage-1"><a href="#Stage-1" class="headerlink" title="Stage 1"></a>Stage 1</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p><strong>输入：</strong> 原始文本<br><strong>输出：</strong> 陈述句</p>
<p>过于复杂的句子往往会导致不自然或者没有意义的问句，因此我们首先需要进行预处理以便简化 transformation。可以做的比如移除一些短语类型，像是句子开始的连词，句子层次的修饰语等，在论文 headline generation (Dorr and Zajic, 2003) and summarization (Toutanova et al., 2007) 中有具体介绍。一些规则如下</p>
<img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/2.jpg" class="ful-image" alt="2.jpg">
<h3 id="Practice"><a href="#Practice" class="headerlink" title="Practice"></a>Practice</h3><p>实际项目中为了得到更快的速度，我们大大简化了这一流程，首先，忽略所有过长的句子(&gt;=50个单词)，其次，只选择 <strong>同位语(APPOSITION)、动词修饰短语(VERB_MODIFIER)、名词动词结构的短语(NP_VP)</strong> 三种类型的句子成分作为产生问句的 candidate。</p>
<p>规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NP_VP = &quot;S &lt; (NP=np ?$PP=pp1 $.. (VP=vp &lt; (/VB.?/=tensed ?$.. SBAR=reason)))&quot;</div><div class="line">APPOSITION = &quot;NP !&lt; CC !&lt; CONJP &lt; (NP=np1 $.. (/,/ $.. (NP=app $.. /,/)))&quot;</div><div class="line">VERB_MODIFIER = &quot;NP=noun &gt; NP $.. VP=modifier&quot;</div></pre></td></tr></table></figure></p>
<p>操作这些规则还是用 tregex，由于是 python，选择 Stanford coreNLP，具体见 <a href="http://www.shuang0420.com/2017/03/24/ParseTree操作若干-Tregex%20and%20Stanford%20CoreNLP/" target="_blank" rel="external">ParseTree操作若干-Tregex and Stanford CoreNLP</a>。</p>
<p>对标注好的部分进行重组，形成规范化的简单句子。以 NP_VP 规则为例，就是形成 NP + VP + PP1的句子。</p>
<h2 id="Stage-2"><a href="#Stage-2" class="headerlink" title="Stage 2"></a>Stage 2</h2><p><strong>输入：</strong> 上一步产生的陈述句<br><strong>输出：</strong> 一个问句集合</p>
<p>先来看一下流程图，下图描述了如何从给定文本产生一个问句，带*的表示特殊疑问句必须的步骤，一般疑问句不需要。<br><img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/0.jpg" class="ful-image" alt="0.jpg"></p>
<p>answer type 可以是名词短语或者是介词短语，能够产生 who, what, where, when, how much 这类的问句。系统可以进行扩展来产生其他的类似 how, why, what kind of 这类的问句。</p>
<p>一个句子可能存在多个可能的 answer phrase，而一个 answer phrase 可能产生多个 question phrase，举个例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Declarative sentence:</div><div class="line">Francium was discovered by Marguerite Perey in France in 1939</div><div class="line"></div><div class="line">Possible questions:</div><div class="line">• Where was francium discovered by Marguerite Perey in 1939?</div><div class="line">• When was francium discovered by Marguerite Perey in France?</div><div class="line">• Was francium discovered by Marguerite Perey in France in 1939?</div><div class="line">• By what was francium discovered in France in 1939?</div></pre></td></tr></table></figure>
<p>当然，最后一个句子是一个错误，Marguerite Perey 应该是个人。Question transducer 会 overgenerate 很多不相关、不重要的问句。这一阶段会用到的技术：</p>
<ul>
<li>mark phrases that cannot be answer phrases, due, for example, to island constraints;</li>
<li>remove each answer phrase and generate possible question phrases for it;</li>
<li>decompose the main verb;</li>
<li>invert the subject and auxiliary verb;</li>
<li>insert one of the question phrases</li>
</ul>
<p>一个完整的例子<br><img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/3.jpg" class="ful-image" alt="3.jpg"></p>
<h3 id="Marking-Unmovable-Phrases"><a href="#Marking-Unmovable-Phrases" class="headerlink" title="Marking Unmovable Phrases"></a>Marking Unmovable Phrases</h3><p>input tree 中有些短语由于 WH-movement 的限制，是不可能作为 answer phrases 的，所以我们可以预先把这些成分用 UNMV- 标记给替换掉，这部分的操作可以是并行的，因为它们的顺序不重要。当然这里有两条规则是例外的，它们用在限制 input tree 的下一步传播，适用于所有其他规则，第一条规则把 UNMV- 节点下的所有节点都标记为 UNMV-。第二条规则把 movable 节点下的所有节点标记为 UNMV-，因为名词短语是可以移动的 islands，名词短语是可以移动的这一事实限制很有用，比如说，在关系从句中的短语是不能移动的，如下面产生的问句是不合理的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Input sentence:</div><div class="line">I bought the book that inspired Bob.</div><div class="line"></div><div class="line">Question:</div><div class="line">Who did I buy the book that inspired?</div></pre></td></tr></table></figure>
<p>具体规则如下：<br><img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/4.jpg" class="ful-image" alt="4.jpg"></p>
<h3 id="Generating-Possible-Question-Phrases"><a href="#Generating-Possible-Question-Phrases" class="headerlink" title="Generating Possible Question Phrases"></a>Generating Possible Question Phrases</h3><p>transducer 查看所有可能的 answer phrase，对每一个可能，复制 input tree，移除 answer phrase，产生可能的 question phrase(这个过程在 yes-no 问句中省略)。</p>
<p>给定一个 answer phrase，question phrase 包含一个 question word(e.g., who,what,where,when)，也可能是个介词短语如 whose car，跟着 answer phrase 的 head。</p>
<p>对一个给定的 answer phrase，系统使用这个短语的 entity label 和句法结构来产生一系列可能的 question phrase，每一个都用来产生最后的问句。下图描述了产生 question phrase 的一些限制。</p>
<img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/5.jpg" class="ful-image" alt="5.jpg">
<h3 id="Practice-1"><a href="#Practice-1" class="headerlink" title="Practice"></a>Practice</h3><p>实践中我们用 spacy 来检测 named entity，主要是因为 spacy 的速度很快，</p>
<p>先对所有 word 进行遍历，找到 PRP 或者 NUM，判断是否能形成 whose 以及 how many/how much 的问题，同时记录是否有 named entity，如果有，再来看 named entity</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if word.tag_.startswith(&apos;PRP&apos;) and is_possessive(word):</div><div class="line">	question_phrase = &apos;whose&apos;</div><div class="line">if word.pos_.startswith(&apos;NUM&apos;) and word.ent_type_ != &apos;DATE&apos;::</div><div class="line">	question_phrase = &apos;how many_how much&apos;</div></pre></td></tr></table></figure>
<p>之所以要分两步，是因为上面的 whose 和 how many/how much 其实是对单词提问的，而剩下的 who/where/when/how/why 是对短语进行提问的。对于 who/where/when，可以用 named entity 来进行识别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">if ne.label_ == &apos;PERSON&apos;:</div><div class="line">	question_phrase = &apos;who&apos;</div><div class="line">if ne.label_ in [&apos;LOC&apos;,&apos;GPE&apos;]:</div><div class="line">	question_phrase = &apos;where&apos;</div><div class="line">if ne.label_ in [&apos;DATE&apos;,&apos;TIME&apos;]:</div><div class="line">	question_phrase = &apos;when&apos;</div></pre></td></tr></table></figure>
<p>对于 why 和 how，基本是基于规则，如果在 reason 部分有 because, since, as 等表示原因的单词，那么就可以产生 why 的问句，如果在 pp2 部分有 using, by, through, with, via 等表示方式的单词，就可以产生 how 的问句。</p>
<p>值得注意的是，有些数字后面跟的是速度的单位，比如说 km/s, mph 等，这时候问 how many(much) km/s 就有点诡异了，所以可以加个判断，如果量词后面跟这些单词，就产生 how fast 的问句；另外有些数字后面如果跟的是 %，那么就变成 how many percent 这种问句。至于用 how many 还是 how much，就看下一个名词是单数还是复数了(注意如果量词是 one，下一个名词是单数，然而提问方式得变成 how many noun_plural)。</p>
<h3 id="Decomposition-of-the-Main-Verb"><a href="#Decomposition-of-the-Main-Verb" class="headerlink" title="Decomposition of the Main Verb"></a>Decomposition of the Main Verb</h3><h4 id="Introduction-1"><a href="#Introduction-1" class="headerlink" title="Introduction"></a>Introduction</h4><p>为了实现 subject-auxiliary inversion，如果一个 auxiliary verb 或者 modal 没有出现，question transducer 将会把主要的动词还原成 do(合适形态) + 动词原形，然后修改动词短语的树的结构。</p>
<p>如 John saw Mary 会变成 John did see Mary。</p>
<p>如果 auxiliary verb 已经存在了，那么并不需要 decomposition，如 John has seen Mary 会变成 Who has John seen。</p>
<p>下图识别了需要 decompose 的动词</p>
<img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/6.jpg" class="ful-image" alt="6.jpg">
<p>另外，可以通过 WordNet 来 lemmatize each verb first by checking morphological variants，每次从动词的最右边去掉一个字母直到在 WordNet 里找到匹配的单词，这种方法非常适合英文因为大多数动词都可以从 lemma 添加几个字母(如 ed)派生得到，或者从 WordNet 里的 lemma 匹配得到。</p>
<h4 id="Practice-2"><a href="#Practice-2" class="headerlink" title="Practice"></a>Practice</h4><p>这里用到了 patterns.en 的包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">from patterns.en import lemma</div><div class="line"># check if contains auxiliary</div><div class="line">def has_auxiliary(head_verb_tag, verb):</div><div class="line">    if head_verb_tag==&apos;MD&apos; or lemma(verb[0]) in [&apos;be&apos;,&apos;do&apos;,&apos;have&apos;] and len(verb)&gt;1:</div><div class="line">        return True</div><div class="line">    return False</div><div class="line"></div><div class="line"></div><div class="line"># decomposition of verb</div><div class="line">def decompose_verb(verb, verb_tag):</div><div class="line">    tense = verb_tense_dict[verb_tag]</div><div class="line">    return conjugate(&apos;do&apos;, tense), lemma(verb)</div></pre></td></tr></table></figure></p>
<h3 id="Subject-Auxiliary-Inversion"><a href="#Subject-Auxiliary-Inversion" class="headerlink" title="Subject-Auxiliary Inversion"></a>Subject-Auxiliary Inversion</h3><p>这一部分仍然是对句子的操作，目的是把陈述句变成问句。</p>
<p>首先，parse tree 的 “S” 需要被重新标记为“SQ”，表示它是问题的一部分。然后移动 auxiliary 或 copula 移动，使它成为 SQ 节点的第一个 child。然后使用 “SQ” 节点为该句子形成一个新树。在 yes-no questions 的情况下，问题树的根节点将具有 “SQ” 节点作为该树唯一的 child。在 WH-questions 的情况下，根节点具有 “SBARQ” 子节点。然后，该 “SBARQ” 节点具有一个问题短语节点(例如“WHNP”) 以及一个 “SQ” 作为子节点。</p>
<p>在转换成问句后，在这个节点和逗号之前的所有修饰语都会被移动到句子的前面，以便产生更自然的问题，如产生 Following Thomas Jefferson, who was elected the 4th president? 而不是 Who, following Thomas Jefferson, was elected the 4th president?</p>
<h3 id="Inserting-Question-Phrases"><a href="#Inserting-Question-Phrases" class="headerlink" title="Inserting Question Phrases"></a>Inserting Question Phrases</h3><p>将每个可能的 question phrase 插入作为 SBARQ 的子节点，如果是一般疑问句，就不用进行这一步了。</p>
<h3 id="Post-processing"><a href="#Post-processing" class="headerlink" title="Post-processing"></a>Post-processing</h3><p>为了保证正确的 formatting and punctuation。句号要改为问号，输出要 detokenized，移除多余的空格。另外，所有包含了代词(pronouns)的问句都太模糊了(e.g., What does it have as a head of state)，所以可以过滤掉所有有人称代词(personal pronouns)，所属代词(possessive pronouns)，以及只包含了限定词(determiners)的名词短语。</p>
<p>当然，改进的版本是进行指代消解。</p>
<h2 id="Stage-3"><a href="#Stage-3" class="headerlink" title="Stage 3"></a>Stage 3</h2><h3 id="Discriminative-reranker"><a href="#Discriminative-reranker" class="headerlink" title="Discriminative reranker"></a>Discriminative reranker</h3><img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/7.jpg" class="ful-image" alt="7.jpg">
<p>上图描述了 bad question 出现的一些原因。在产生一大堆可能的问题后，我们要对问句进行排序。论文提到的是用 logistic regression 来定义一个 acceptable probability p(a|q,t) 和 unacceptable probability p(u|q,t) = 1-p(a|q,t)。先训练一个 boolean model ，只要出现上面的任何一种问题，就认为这个问句是 unacceptable 的。接着训练一个 aggregate model，模型如下</p>
<p>$$p(a|q,t)=\prod^K_{i=1}p_i(a_i|q,t)$$</p>
<p>其中 i 是影响 acceptable 的各个因素(grammaticality, making sense, vagueness, etc.), K 在这里是 8。</p>
<p>用到的特征如下图，目标函数是 regularized log-likelihood，regularizaiton constant 由 cross-validation 选择产生。用到的训练集有 WIKI-ENG，WIKI-SIMP 和 theWall Street Journal data in the Penn Treebank</p>
<p>(Marcus et al., 1993)。实验结果表明，aggregate ranking 在 P@10 上提升了 43.3%，在 P@25 上提升了40%。</p>
<img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/8.jpg" class="ful-image" alt="8.jpg">
<h3 id="Practice-3"><a href="#Practice-3" class="headerlink" title="Practice"></a>Practice</h3><p>实际中我们并没有来训练模型，主要是因为找不到合适的有标注的训练集。我们用了非常简单的几个标准来进行排序。</p>
<ul>
<li>Complexity<br>看 question 包含了多少个单词<br>划分4 个 bucket [0, 5], [5, 20], [20, 30], [30,…]，如果在 [5,20] 之间，给最高分，在 [0, 5] 或者 [30,…] 间，就给 penalty</li>
<li>Difficulty<br>基本假设是一个好的问题应该有一个确定的答案与之相配。理想情况下是看这个问句能不能被回答，以及容不容易被回答。<br>然而这里的答案抽取、问题产生大部分依赖规则，所以也用规则来定义问题难度了，认为 what, why, how 比较难回答， question word 在中间的句子比较难回答，这些规则通过观察部分有标签的数据集得到</li>
<li>Diversity<br>给每种类型的问句设置权重，在结果集里各类问句都按比例出现，保证多样性</li>
<li>Fluency<br>用 ginger server 来检查语法</li>
</ul>
<h1 id="Yes-No-Question"><a href="#Yes-No-Question" class="headerlink" title="Yes/No Question"></a>Yes/No Question</h1><p>举个例子说明 binary question<br>例句1 (包含 auxiliary verb 或者 modal)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">The cat had/MD slept/VBD on the mat.</div></pre></td></tr></table></figure></p>
<p>我们需要做的是将 MD 前置，拼接句子，将句尾符号变为问号，成为答案是 YES 的问句。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">=&gt; Had the cat slept on the mat?</div><div class="line"></div><div class="line">Yes!</div></pre></td></tr></table></figure></p>
<p>例句2 (不包含 auxiliary verb 或者 modal)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">The cat slept/VBD on the mat.</div></pre></td></tr></table></figure></p>
<p>我们需要做的是 decompose verb，把 slept 变成 did sleep，然后将 did 前置，拼接句子，将句尾符号变为问号，成为答案是 YES 的问句。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">=&gt; Did the cat slept on the mat?</div><div class="line"></div><div class="line">Yes!</div></pre></td></tr></table></figure></p>
<p><strong>怎么产生答案是 NO 的句子？</strong></p>
<p>将句子中的 head word 随机替换成同等词性的词。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">=&gt; Had the dog slept on the mat?</div><div class="line"></div><div class="line">No!</div></pre></td></tr></table></figure></p>
<h1 id="WH-Question"><a href="#WH-Question" class="headerlink" title="WH Question"></a>WH Question</h1><p> <strong>Detect Candidate Sentences and Mark Movable Phrases</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- Input:</div><div class="line">In 2008, because Olympics is coming, 5 valuable pandas including Jingjing were born in Beijing, China.</div><div class="line">- Rule:</div><div class="line">S &lt; (NP=np ?$PP=pp1 $.. (VP=vp &lt; (/VB.?/=tensed ?$.. SBAR=reason)))</div></pre></td></tr></table></figure>
<img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/9.jpg" class="ful-image" alt="9.jpg">
<p><strong>Yes-no Questions</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- Yes Question:</div><div class="line">Were 5 valuable pandas including Jingjing born in Beijing , China in 2008?</div><div class="line">- No Question:</div><div class="line">Were the swallows born in Beijing , China in 2008?</div></pre></td></tr></table></figure>
<p><strong>Choose Answer Phrases and Generate Question Phrases</strong></p>
<img src="http://images.shuang0420.com/images/QA%20system%20-%20Question%20Generation/10.jpg" class="ful-image" alt="10.jpg">
<p><strong>Decompose Verb</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Eg.1. In 2008, because Olympics is coming, 5 valuable pandas including Jingjing were born in Beijing, China.</div><div class="line">were =&gt; were</div><div class="line">Eg.2. All four allies retained shared responsibility for Berlin.</div><div class="line">retained =&gt; did retain</div></pre></td></tr></table></figure>
<p><strong>Invert Subject and Auxiliary and Insert Question Phrase</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- Input:</div><div class="line">5 valuable pandas including Jingjing were born in Beijing, China.</div><div class="line">- Output:</div><div class="line">were 5 valuable pandas including jingjing born in Beijing , China in 2008</div><div class="line">were 5 valuable pandas including jingjing born in Beijing , China in 2008</div><div class="line">where were 5 valuable pandas including Jingjing born in 2008</div><div class="line">when were 5 valuable pandas including Jingjing born in Beijing , China</div><div class="line">how many valuable pandas including Jingjing were born in Beijing , China in 2008</div><div class="line">what were born in Beijing , China in 2008</div></pre></td></tr></table></figure>
<p><strong>Post Processing</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- Input:</div><div class="line">5 valuable pandas including Jingjing were born in Beijing, China.</div><div class="line">- Output:</div><div class="line">Where were 5 valuable pandas including Jingjing born in 2008?</div><div class="line">Were 5 valuable pandas including jingjing born in Beijing , China in 2008?</div><div class="line">When were 5 valuable pandas including Jingjing born in Beijing , China?</div><div class="line">How many valuable pandas including Jingjing were born in Beijing , China in 2008?</div><div class="line">What were born in Beijing , China in 2008?</div><div class="line">Were 5 valuable pandas including Jingjing born in Beijing , China in 2008?</div></pre></td></tr></table></figure>
<h1 id="Tools-Packages"><a href="#Tools-Packages" class="headerlink" title="Tools/Packages"></a>Tools/Packages</h1><ul>
<li>python==2.7</li>
<li>spaCy==1.7.5</li>
<li>pattern==2.6</li>
<li>textblob==0.12.0</li>
<li>nltk==3.2.2</li>
<li>requests==2.13.0</li>
<li>scipy==0.18.1</li>
<li>sklearn==0.18.1</li>
<li>numpy==1.11.3</li>
<li>stanford-corenlp-full-2016-10-31</li>
</ul>
<h1 id="历程"><a href="#历程" class="headerlink" title="历程"></a>历程</h1><h2 id="第一阶段"><a href="#第一阶段" class="headerlink" title="第一阶段"></a>第一阶段</h2><ul>
<li>只寻找 NP VP 结构，用的 pattern 为 S &lt; (NP=np $.. (VP=vp &lt; /VB.?/=tensed))</li>
<li>主语为代词(PROP)跳过，不做指代消解(速度慢)</li>
<li>NER 考虑了 PERSON, LOC, GPE</li>
<li>对每个句子产生 yes/no 问句，包含 NER 的产生对应的 WHAT/WHO/WHERE 问句</li>
</ul>
<p>原文(PART)</p>
<blockquote>
<p>Ant</p>
<p>Ants are social insects of the family Formicidae ( ), and along with the related wasps and bees, they belong to the order Hymenoptera. Ants evolved from wasp-like ancestors in the mid-Cretaceous period between 110 and 130 million years ago and diversified after the rise of flowering plants. Today, more than 12,500 species are classified with upper estimates of about 22,000 species.          They are easily identified by their elbowed antennae and a distinctive node-like structure that forms a slender waist.</p>
<p>Ants form colonies that range in size from a few dozen predatory individuals living in small natural cavities to highly organised colonies which may occupy large territories and consist of millions of individuals. These larger colonies consist mostly of sterile wingless females forming castes of “workers”, “soldiers”, or other specialised groups. Nearly all ant colonies also have some fertile males called “drones” and one or more fertile females called “queens”. The colonies are sometimes described as superorganisms because the ants appear to operate as a unified entity, collectively working together to support the colony.</p>
</blockquote>
<p>产生问句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">NP VP(aux)	Are ants social insects of the family Formicidae -LRB- -RRB-</div><div class="line">WHO NP VP	Who are ants</div><div class="line">WHAT NP VP	What are ants</div><div class="line">NP VP(aux)	Are more than 12,500 species classified with upper estimates of about 22,000 species</div><div class="line">WHAT NP VP(aux)	What are more than 12,500 species</div><div class="line">NP VP(no-aux)	Do ants form colonies that range in size from a few dozen predatory individuals living in small natural cavities to highly organised colonies which may occupy large territories and consist of millions of individuals</div><div class="line">WHAT NP VP(aux)	What do ants form</div><div class="line">NP VP(no-aux)	Do these larger colonies consist mostly of sterile wingless females forming castes of `` workers &apos;&apos; , `` soldiers &apos;&apos; , or other specialised groups</div><div class="line">WHAT NP VP(aux)	What do these larger colonies consist</div><div class="line">NP VP(no-aux)	Did males call `` drones &apos;&apos; and one</div><div class="line">WHAT NP VP(aux)	What did males call</div><div class="line">NP VP(aux)	Have nearly all ant colonies some fertile males called `` drones &apos;&apos; and one or more fertile females called `` queens &apos;&apos;</div><div class="line">WHAT NP VP(aux)	What did nearly all ant colonies some</div><div class="line">NP VP(no-aux)	Do the ants appear to operate as a unified entity , collectively working together to support the colony</div><div class="line">WHAT NP VP(aux)	What do the ants appear</div><div class="line">NP VP(aux)	Are the colonies sometimes described as superorganisms because the ants appear to operate as a unified entity , collectively working together to support the colony</div><div class="line">WHAT NP VP(aux)	What are the colonies</div><div class="line">NP VP(aux)	Have ants colonised almost every landmass on Earth</div><div class="line">WHERE NP VP(aux) 	Where did ants colonise colonised</div><div class="line">NP VP(aux)	Are the only places lacking indigenous ants Antarctica and certain remote or inhospitable islands</div><div class="line">WHERE NP VP(aux) 	Where are the only places lacking indigenous ants are</div><div class="line">NP VP(aux)	Has their long co-evolution with other species led to mimetic , commensal , parasitic , and mutualistic relationships</div><div class="line">WHAT NP VP(aux)	What did their long co-evolution with other species lead</div><div class="line">NP VP(aux)	Have hlldobler &amp; Wilson -LRB- 1990 -RRB- , p. 471 Ant societies division of labour , communication between individuals , and an ability to solve complex problems</div><div class="line">WHAT NP VP(aux)	What did hlldobler &amp; Wilson -LRB- 1990 -RRB- , p. 471 Ant societies division</div><div class="line">NP VP(aux)	Have these parallels with human societies long been an inspiration and subject of study</div><div class="line">WHAT NP VP(aux)	What did these parallels with human societies long</div><div class="line">NP VP(no-aux)	Do many human cultures make use of ants in cuisine , medication and rituals</div><div class="line">WHAT NP VP(aux)	What do many human cultures make</div><div class="line">NP VP(aux)	Are some species valued in their role as biological pest control agents</div><div class="line">WHAT NP VP(aux)	What are some species</div><div class="line">NP VP(aux)	Is the word ant derived from ante of Middle English which is derived from mette of Old English and is related to the Old High German meiza , hence the modern German Ameise</div><div class="line">WHERE NP VP(aux) 	Where is the word ant derived is derived is related</div><div class="line">WHO NP VP	Who is the word ant</div><div class="line">WHAT NP VP	What is the word ant</div><div class="line">NP VP(aux)	Was the original meaning of the word `` the biter &apos;&apos; -LRB- from Proto-Germanic * ai - , `` off , away &apos;&apos; + * mait - `` cut &apos;&apos; -RRB-</div><div class="line">WHAT NP VP(aux)	What was the original meaning of the word</div><div class="line">NP VP(no-aux)	Do all of these words come from West Germanic * amaitjo</div><div class="line">WHERE NP VP(aux) 	Where do all of these words come</div><div class="line">NP VP(aux)	Are the words in other Romance languages such as the Portuguese formiga , Italian formica , Spanish hormiga , Romanian furnic and French fourmi derived</div><div class="line">WHAT NP VP(aux)	What are the words in other Romance languages such as the Portuguese formiga , Italian formica , Spanish hormiga , Romanian furnic and French fourmi</div><div class="line">NP VP(aux)	Is the family name Formicidae derived from the Latin formca -LRB- `` ant &apos;&apos; -RRB- from which the words in other Romance languages such as the Portuguese formiga , Italian formica , Spanish hormiga , Romanian furnic and French fourmi are derived</div><div class="line">WHAT NP VP(aux)	What is the family name Formicidae</div><div class="line">NP VP(no-aux)	Does formicidae belong to the order Hymenoptera , which also includes sawflies , bees and wasps</div><div class="line">WHAT NP VP(aux)	What does formicidae belong</div><div class="line">NP VP(no-aux)	Did ants fossilise in Baltic amber The family Formicidae belongs to the order Hymenoptera , which also includes sawflies , bees and wasps</div><div class="line">WHO NP VP	Who did ants fossilise</div><div class="line">WHAT NP VP	What did ants fossilise</div><div class="line">NP VP(no-aux)	Did ants evolve from a lineage within the vespoid wasps</div><div class="line">WHAT NP VP(aux)	What did ants evolve</div></pre></td></tr></table></figure>
<p>第一个问题是指代消解，如下面这个句子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Ants are social insects of the family Formicidae ( ), and along with the related wasps and bees, they belong to the order Hymenoptera.</div><div class="line"></div><div class="line">Is supposed to generate</div><div class="line">=&gt;</div><div class="line">NP VP(no-aux)Do ants belong to the order Hymenoptera</div><div class="line">WH NP VP(no-aux)What do ants belong to</div></pre></td></tr></table></figure>
<p>应该同时能产生这两个问题，然而现在的代码遇到代词直接跳过，并没有进行匹配，所以不能产生。可以用 standford parser 做一次指代消解，然而再请求一次，加上标注、parse，时间上耗费太久。所以现在想着把上一步的 np 存到一个 list 里，如果下一个 np 匹配找到的是 PRP，就用 np 里的替换。这个解决方案也可以为产生 yes-no question 的 no question 做准备。</p>
<p>第二个问题是介词造成的不完整句子，需要对介词进行进一步处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">What does ants consist =&gt; What does ants consist of</div></pre></td></tr></table></figure>
<p>第三个问题是关于 have，have 可以作为完成时的 auxiliary，也可以作为行为动词 ‘have’ 表示拥有，而这里我默认了 have 作为 auxiliary 出现，其实是不对的，需要分情况讨论</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Have nearly all ant colonies some fertile males called `` drones &apos;&apos; and one or more fertile females called `` queens &apos;&apos;</div><div class="line"></div><div class="line">is supposed to be</div><div class="line">=&gt;</div><div class="line">Do nearly all ant colonies have some fertile males called `` drones &apos;&apos; and one or more fertile females called `` queens &apos;&apos;</div></pre></td></tr></table></figure>
<p>类似的问题是 be，比如 ‘A is B’ 和 ‘A is described as B’ 应该区分对待。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">NP VP(aux)	Are the colonies sometimes described as superorganisms because the ants appear to operate as a unified entity , collectively working together to support the colony ?</div><div class="line">=&gt;</div><div class="line">WHAT NP VP	What are the colonies ?</div><div class="line"></div><div class="line">is supposed to be</div><div class="line">=&gt;</div><div class="line">What are the colonies described as ?</div></pre></td></tr></table></figure>
<p>然而这里有一个难点是 ‘A is described as B’ 和 ‘A is valued ‘</p>
<p>第四个问题是疑问词，因为只 handle 了 WHO, WHAT, WHERE 的问题，而实际上，一些问句应该是 WHEN 的问题，如下。现在想到的是对于包含介词短语的句子，同时产生 WHERE 和 WHEN 两种问句类型，同样的，对于之前产生 WHO 的句子，也产生一个 WHAT 版本，然后由 QUESTION RANKING 来排序筛选。</p>
<p>关于 WHEN，尽量用命名实体 TIME 以及正则规则匹配，准确率会更高一些。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Ants evolved from wasp-like ancestors in the mid-Cretaceous period between 110 and 130 million years ago and diversified after the rise of flowering plants.</div><div class="line">=&gt; What did ants diversify</div><div class="line">Supposed to be</div><div class="line">=&gt; When did ants diversify</div></pre></td></tr></table></figure>
<p>最后还有一些特殊符号的匹配，可以通过 post-processing 做处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-LRB- -RRB-   =&gt; ()</div><div class="line">`` 	=&gt; &quot;</div></pre></td></tr></table></figure>
<h2 id="第二阶段"><a href="#第二阶段" class="headerlink" title="第二阶段"></a>第二阶段</h2><p>基本解决了第一阶段的问题，并加了 ranking。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">Do ants form colonies that range in size from a few dozen predatory individuals living in small natural cavities to highly organised colonies which may occupy large territories and consist of millions of individuals ?</div><div class="line">More than 12,500 species are classified with upper estimates of about how many species ?</div><div class="line">What do ants form that range in size from a few dozen predatory individuals living in small natural cavities to highly organised colonies which may occupy large territories and consist of millions of individuals ?</div><div class="line">What have some fertile males called drones and one or more fertile females called queens ?</div><div class="line">Do males appear to operate as a unified entity , collectively working together to support the colony ?</div><div class="line">How many species are more than 12,500 species classified with ?</div><div class="line">What are classified with upper estimates of about 22,000 species ?</div><div class="line">Are ants social insects of the family Formicidae ?</div><div class="line">What do these larger colonies consist forming castes of workers , soldiers , or other specialised groups ?</div><div class="line">Are more than 12,500 species classified with upper estimates of about 22,000 species ?</div><div class="line">Do more than 12,500 species consist mostly of sterile wingless females forming castes of workers , soldiers , or other specialised groups ?</div><div class="line">Do these larger colonies consist mostly of sterile wingless females forming castes of workers , soldiers , or other specialised groups ?</div><div class="line">What did males call and one ?</div><div class="line">What form colonies that range in size from a few dozen predatory individuals living in small natural cavities to highly organised colonies which may occupy large territories and consist of millions of individuals ?</div><div class="line">Are people classified with upper estimates of about 22,000 species ?</div><div class="line">Do people have some fertile males called drones and one or more fertile females called queens ?</div><div class="line">What do the ants appear , collectively working together to support the colony ?</div><div class="line">Do the ants appear to operate as a unified entity , collectively working together to support the colony ?</div><div class="line">What do nearly all ant colonies have called drones and one or more fertile females called queens ?</div><div class="line">Do nearly all ant colonies have some fertile males called drones and one or more fertile females called queens ?</div><div class="line">Are nearly all ant colonies sometimes described as superorganisms because the ants appear to operate as a unified entity , collectively working together to support the colony ?</div><div class="line">How many species are classified with upper estimates of about 22,000 species ?</div><div class="line">Did males call drones and one ?</div><div class="line">What are ants of the family Formicidae ?</div><div class="line">Are people social insects of the family Formicidae ?</div><div class="line">What are more than 12,500 species classified with of about 22,000 species ?</div><div class="line">What are the colonies because the ants appear to operate as a unified entity , collectively working together to support the colony ?</div><div class="line">What appear to operate as a unified entity , collectively working together to support the colony ?</div><div class="line">What called drones and one ?</div><div class="line">What are social insects of the family Formicidae ?</div><div class="line">What are sometimes described as superorganisms because the ants appear to operate as a unified entity , collectively working together to support the colony ?</div><div class="line">What consist mostly of sterile wingless females forming castes of workers , soldiers , or other specialised groups ?</div><div class="line">Are the colonies sometimes described as superorganisms because the ants appear to operate as a unified entity , collectively working together to support the colony ?</div></pre></td></tr></table></figure>
<!--

# 系统

把文档转化为 sentence parse tree 的集合，首先进行一次过滤:

- 删掉太短/太长的句子
- 删掉没有动词(Verb)的句子
- 删掉有很多介词短语(PRP)的句子


## 人工规则

人工定义一些规则，比如说有两个名词短语(NP)中间由逗号隔开，那么，很可能是同位语，就可以转化成 NP1 is NP2 的形式



## WH Question

主要根据有 NER 标签的句子产生，通常看句子第一个单词的 NER 属性，如果是 person，就转化成 WHO 的问句，如

Donovan/B-noun.PERSON went/O to/O Paris/B-noun.LOCATION.

=> Who went to Paris?



## Score

### Reasonable
看句子是不是太长/太短，是不是有否定词看起来让人摸不着头脑

### Fluent
找 question treebank，看句子符合一个英文问句语法的概率是多少


### Intelligent
一个好的问题往往有一个好的答案



# Process
1. Answer type
2. Tag
3. Look only the words that are not in the question, see if the tag matches the answer type
4. Return the smallest subtree containing these words




YES/NO
all the important words in question are in the same answer source, if not, we say not, if reasonable, we say yes
-->
<blockquote>
<p>参考链接：<br><a href="http://www.cs.cmu.edu/~mheilman/papers/heilman-smith-qg-tech-report.pdf" target="_blank" rel="external">Question Generation via Overgenerating Transformations and Ranking</a></p>
</blockquote>

      
    </div>

    <div>
      
        
<div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat.jpg" alt="徐阿衡 wechat" style="width: 200px; max-width: 100%;"/>
    <div>欢迎关注：徐阿衡的微信公众号</div>
</div>


      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>客官，打个赏呗~</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://7xu83c.com1.z0.glb.clouddn.com/1.pic.jpg" alt="徐阿衡 WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/NLP/" rel="tag">#NLP</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/03/EMR 大文件操作及 Mapreduce 按 Value 排序若干/" rel="next" title="EMR 大文件操作及 Mapreduce 按 Value 排序若干">
                <i class="fa fa-chevron-left"></i> EMR 大文件操作及 Mapreduce 按 Value 排序若干
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/07/NLP 笔记 - Meaning Representation Languages/" rel="prev" title="NLP 笔记 - Meaning Representation Languages">
                NLP 笔记 - Meaning Representation Languages <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      



    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
     
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://7xu83c.com1.z0.glb.clouddn.com/2.pic.jpg"
               alt="徐阿衡" />
          <p class="site-author-name" itemprop="name">徐阿衡</p>
          <p class="site-description motion-element" itemprop="description">读万卷书，行万里路 @SYSU @CMU</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">166</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">126</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Shuang0420" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.linkedin.com/in/shuang-xu-7008b894?trk=nav_responsive_tab_profile_pic" target="_blank" title="LinkedIn">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  LinkedIn
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://zhuanlan.zhihu.com/c_136690664" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://starllap.space" title="Star" target="_blank">Star</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://liam0205.me" title="Liam Huang" target="_blank">Liam Huang</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.libinx.com" title="Li Bin" target="_blank">Li Bin</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#QG-Framework"><span class="nav-number">1.</span> <span class="nav-text">QG Framework</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Stage-1"><span class="nav-number">1.1.</span> <span class="nav-text">Stage 1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Introduction"><span class="nav-number">1.1.1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Practice"><span class="nav-number">1.1.2.</span> <span class="nav-text">Practice</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Stage-2"><span class="nav-number">1.2.</span> <span class="nav-text">Stage 2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Marking-Unmovable-Phrases"><span class="nav-number">1.2.1.</span> <span class="nav-text">Marking Unmovable Phrases</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Generating-Possible-Question-Phrases"><span class="nav-number">1.2.2.</span> <span class="nav-text">Generating Possible Question Phrases</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Practice-1"><span class="nav-number">1.2.3.</span> <span class="nav-text">Practice</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Decomposition-of-the-Main-Verb"><span class="nav-number">1.2.4.</span> <span class="nav-text">Decomposition of the Main Verb</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Introduction-1"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Practice-2"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">Practice</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Subject-Auxiliary-Inversion"><span class="nav-number">1.2.5.</span> <span class="nav-text">Subject-Auxiliary Inversion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Inserting-Question-Phrases"><span class="nav-number">1.2.6.</span> <span class="nav-text">Inserting Question Phrases</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Post-processing"><span class="nav-number">1.2.7.</span> <span class="nav-text">Post-processing</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Stage-3"><span class="nav-number">1.3.</span> <span class="nav-text">Stage 3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Discriminative-reranker"><span class="nav-number">1.3.1.</span> <span class="nav-text">Discriminative reranker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Practice-3"><span class="nav-number">1.3.2.</span> <span class="nav-text">Practice</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Yes-No-Question"><span class="nav-number">2.</span> <span class="nav-text">Yes/No Question</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WH-Question"><span class="nav-number">3.</span> <span class="nav-text">WH Question</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tools-Packages"><span class="nav-number">4.</span> <span class="nav-text">Tools/Packages</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#历程"><span class="nav-number">5.</span> <span class="nav-text">历程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#第一阶段"><span class="nav-number">5.1.</span> <span class="nav-text">第一阶段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二阶段"><span class="nav-number">5.2.</span> <span class="nav-text">第二阶段</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <!-- Other code may be here -->
<div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">徐阿衡</span>
  <a href="http://www.miitbeian.gov.cn/">粤ICP备17129486号</a>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>


<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'httpshuang0420githubio';
      var disqus_identifier = '2017/04/06/QA system - Question Generation/';
      var disqus_title = "QA system - Question Generation";
      var disqus_url = 'http://www.shuang0420.cn/2017/04/06/QA system - Question Generation/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>
</html>
