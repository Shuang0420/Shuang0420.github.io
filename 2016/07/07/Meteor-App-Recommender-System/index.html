<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />













  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Crawler,Meteor," />





  <link rel="alternate" href="/atom.xml" title="徐阿衡" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.3" />






<meta name="description" content="Meteor 是一个构建在 Node.js 之上的平台，用来开发实时网页程序，这一篇用 Meteor 搭建 App_Recommender_System 的 front-end.">
<meta property="og:type" content="article">
<meta property="og:title" content="Meteor--App_Recommender_System">
<meta property="og:url" content="http://www.shuang0420.com/2016/07/07/Meteor-App-Recommender-System/index.html">
<meta property="og:site_name" content="徐阿衡">
<meta property="og:description" content="Meteor 是一个构建在 Node.js 之上的平台，用来开发实时网页程序，这一篇用 Meteor 搭建 App_Recommender_System 的 front-end.">
<meta property="og:image" content="http://7xu83c.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-07%20%E4%B8%8A%E5%8D%8810.38.31.png">
<meta property="og:image" content="http://7xu83c.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-07%20%E4%B8%8B%E5%8D%886.03.40.png">
<meta property="og:updated_time" content="2020-06-16T13:21:44.171Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Meteor--App_Recommender_System">
<meta name="twitter:description" content="Meteor 是一个构建在 Node.js 之上的平台，用来开发实时网页程序，这一篇用 Meteor 搭建 App_Recommender_System 的 front-end.">
<meta name="twitter:image" content="http://7xu83c.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-07%20%E4%B8%8A%E5%8D%8810.38.31.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '6294135991397516000',
      author: '阿衡'
    }
  };
</script>

<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6146435155426457",
    enable_page_level_ads: true
  });
</script>




  <link rel="canonical" href="http://www.shuang0420.com/2016/07/07/Meteor-App-Recommender-System/"/>


  <title> Meteor--App_Recommender_System | 徐阿衡 </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="en">

  










  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">徐阿衡</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Shuang</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-works">
          <a href="/works" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Works
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/aboutme" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input" placeholder="search my blog...">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
         
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Meteor--App_Recommender_System
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-07-07T21:19:08+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Web-Application/" itemprop="url" rel="index">
                    <span itemprop="name">Web Application</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/Meteor-App-Recommender-System/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/07/Meteor-App-Recommender-System/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
              &nbsp; | &nbsp;
              <span class="page-pv"><i class="fa fa-file-o"></i>
              <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
              </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Meteor 是一个构建在 Node.js 之上的平台，用来开发实时网页程序，这一篇用 Meteor 搭建 App_Recommender_System 的 front-end.<br><a id="more"></a></p>
<h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="Meteor-的创新"><a href="#Meteor-的创新" class="headerlink" title="Meteor 的创新"></a>Meteor 的创新</h2><p>Meteor 的关键性创新在于 Rails 程序只跑在服务器上，而一个 Meteor App 还包括在客户端（浏览器）上运行的客户端组件。这就相当于书店的伙计不仅仅在书店里帮你找书，还跟你回家，每天晚上读给你听（这听起来怪怪的）。<br>这种架构让 Meteor 变得数据库无处不在。简单说，Meteor 把你的数据拿出一部分子集复制到客户端。这样后两个主要结果：第一，服务器不再发送 HTML 代码到客户端，而是发送真实的原始数据，让客户端决定如何处理线传数据。第二，你可以不必等待服务器传回数据，而是立即访问甚至修改数据（延迟补偿 latency compensation）。</p>
<h2 id="Meteor-特点"><a href="#Meteor-特点" class="headerlink" title="Meteor 特点"></a>Meteor 特点</h2><p>Meteor 位于程序数据库和用户界面之间，保持二者之间的数据同步更新。除此之外，Meteor 还有以下特点：</p>
<ol>
<li>纯数据对话。服务器与客户端初始化后只传输数据，由客户端决定如何渲染。</li>
<li>一种语言。前后端统一使用 JavaScript 进行开发。</li>
<li>无处不在的数据库。浏览器端使用与服务器端一致的 API 访问本地数据库。</li>
<li>延迟补偿。在客户端使用预取和数据模型模拟技术，提供接近零延迟的数据库连接体验。</li>
<li>全栈响应式。实时作为默认模式，从数据库到模版的所有层面上，都应当具备可用的事件驱动接口。</li>
<li>社区生态友好。Meteor 开放源代码并能与现有的开源工具和框架整合，而非取代它们</li>
<li>简单即生产力。让事情看起来简单的最佳方式就是让它真正变得简单，通过干净且具古典美的 API 来实现。</li>
</ol>
<h2 id="Meteor-结构"><a href="#Meteor-结构" class="headerlink" title="Meteor 结构"></a>Meteor 结构</h2><p>一般来说需要新建四个子文件夹：/client，/server，/public 和 /lib。然后在 /client 文件夹中新建 main.html 和 main.js 文件。这些文件夹中有一些拥有特别的作用。</p>
<h3 id="Meteor-文件规则"><a href="#Meteor-文件规则" class="headerlink" title="Meteor 文件规则"></a>Meteor 文件规则</h3><ul>
<li>在 /server 文件夹中的代码只会在服务器端运行。</li>
<li>在 /client 文件夹中的代码只会在客户端运行。</li>
<li>其它代码则将同时运行于服务器端和客户端上。</li>
<li>请将所有的静态文件（字体，图片等）放置在 /public 文件夹中。</li>
</ul>
<h3 id="Meteor-加载文件顺序"><a href="#Meteor-加载文件顺序" class="headerlink" title="Meteor 加载文件顺序"></a>Meteor 加载文件顺序</h3><ul>
<li>在 /lib 文件夹中的文件将被优先载入。</li>
<li>所有以 main.* 命名的文件将在其他文件载入后载入。</li>
<li>其他文件以文件名的字母顺序载入。</li>
</ul>
<h2 id="Meteor-核心概念"><a href="#Meteor-核心概念" class="headerlink" title="Meteor 核心概念"></a>Meteor 核心概念</h2><h3 id="模板系统-Spacebars"><a href="#模板系统-Spacebars" class="headerlink" title="模板系统 Spacebars"></a>模板系统 Spacebars</h3><p>Spacebar 就是简单的 HTML 加上三件事情：Inclusion （有时也称作 “partial”）、Expression 和 Block Helper。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- Inclusion ：通过 &#123;&#123;&gt; templateName&#125;&#125; 标记，简单直接地告诉 Meteor 这部分需要用相同名称的模板来取代</div><div class="line">- Expression ：比如 &#123;&#123;title&#125;&#125; 标记，它要么是调用当前对象的属性，要么就是对应到当前模板管理器中定义的 helper 方法，并返回其方法值。</div><div class="line">- Block Helper ：在模板中控制流程的特殊标签，如 &#123;&#123;#each&#125;&#125;…&#123;&#123;/each&#125;&#125; 或 &#123;&#123;#if&#125;&#125;…&#123;&#123;/if&#125;&#125; 。</div></pre></td></tr></table></figure></p>
<p>模板的作用局限于显示或循环变量，而 helper 则扮演着一个相当重要的角色：把值分配给每个变量。</p>
<p><a href="https://github.com/meteor/meteor/blob/devel/packages/spacebars/README.md" target="_blank" rel="external">Spacebars 文档</a></p>
<h3 id="collection"><a href="#collection" class="headerlink" title="collection"></a>collection</h3><p>meteor collection 是 MongoDB Collections 的扩展，在 server 下插入 collection 的数据将会在 MongoDB 自动更新。任何在 client 下 publish 的数据将会在客户端页面实时显示。</p>
<blockquote>
<p>All    collections    are    reactively updated on    both the client    and    the server.    If a new app were    published    to our store,    and    thousands    of clients were    connected, all of    their    app    stores would update immediately    without    any    extra    work on    our    end!</p>
</blockquote>
<h4 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h4><p>在服务器，collection 有一个任务就是和 Mongo 数据库联络，读取任何数据变化。 在这种情况下，它可以比对标准的数据库。<br>collection 还可以像 API 一样操作 Mongo 数据库。在服务器端的代码，你可以写像 Posts.insert() 或 Posts.update() 这样的 Mongo 命令，来对 Mongo 数据库中的 posts 集合进行操作。</p>
<h4 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h4><p>在客户端，collection 是一个安全拷贝来自于实时一致的数据子集。客户端的 collection 总是（通常）透明地实时更新数据子集。当你在客户端申明 Posts = new Mongo.Collection(‘posts’); 你实际上是创建了一个本地的，在浏览器缓存中的真实的 Mongo 集合。 当我们说客户端 collection 被”缓存”是指它保存了你数据的一个子集，而且对这些数据提供了十分快速的访问。</p>
<p>有一点我们必须要明白，因为这是 Meteor 工作的一个基础: 通常说来，客户端的集合的数据是你 Mongo 数据库的所有数据的一个子集（毕竟我们不会想把整个数据库的数据全传到客户端来）。</p>
<p>另外，那些数据是被存储在浏览器内存中的，也就是说访问这些数据几乎不需要时间，不像去服务器访问 Posts.find() 那样需要等待，因为数据事实上已经载入了。</p>
<h4 id="客户端-服务器通讯"><a href="#客户端-服务器通讯" class="headerlink" title="客户端-服务器通讯"></a>客户端-服务器通讯</h4><p>实际情况是服务器端的 collection 被客户端的 collection 通知说有一个新 item，然后执行了一个任务把这个 item 放入 Mongo 数据库，进而送到所有连接着的客户端。<br>在浏览器的控制台取出所有的 item 没什么用处。需要把这些数据显示在模板中，并把这个简单的 HTML 原型变成一个有用的实时 Web 应用。</p>
<h3 id="发布（Publication）和订阅（Subscription）"><a href="#发布（Publication）和订阅（Subscription）" class="headerlink" title="发布（Publication）和订阅（Subscription）"></a>发布（Publication）和订阅（Subscription）</h3><p>collection 通过发布（publications）和订阅（subscriptions）机制把数据实时同步上行或者下行到连接着的各个用户的浏览器或者Mongo数据库中。Meteor App 保证只发布你让这个当前用户看到的数据。autopublish 的目的是让 Meteor 应用有个简单的起步阶段，它简单地直接把服务器上的全部数据镜像到客户端，因此你就不用管发布和订阅了。然而在实际工程中，我们需要删除它。</p>
<pre>meteor remove autopublish</pre>

<h4 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h4><p>一个 App 的数据库可能用上万条数据，其中一些还可能是私用和保密敏感数据。显而易见我们不能简单地把数据库镜像到客户端去，无论是安全原因还是扩展性原因。<strong>发布</strong> 就是告诉 Meteor 哪些数据子集是需要送到客户端。<br>为达到这个目的，我们建立一个简单的 Publish() 函数，只发布没有打标记的帖子</p>
<pre>
// 在服务器端
Meteor.publish('posts', function() {
  return Posts.find({flagged: false});
});</pre>

<h4 id="订阅"><a href="#订阅" class="headerlink" title="订阅"></a>订阅</h4><p><strong>订阅</strong> 就是让客户端来确定哪些子集是他们在某个特别时候特别需要的。</p>
<p>在客户端我们需要订阅这个发布。我们仅仅需要增加这样一行到 main.js 文件中</p>
<pre>Meteor.subscribe('posts');</pre>

<p>Meteor 程序在客户端能够具有可伸缩性：不去订阅全部数据，而是指选择你现在需要的数据去订阅。这样的话，你就可以避免消耗大量的客户端内存，无论服务器端的总数据量有多大。</p>
<h4 id="DDP"><a href="#DDP" class="headerlink" title="DDP"></a>DDP</h4><p> 基本上我们可以把发布/订阅模式想象成为一个漏斗，从服务器端（数据源）过滤数据传送到客户端（目标）。<br> 这个漏斗的专属协议叫做 DDP（分布式数据协议 Distributed Data Protocol 的缩写）。如果想了解 DDP 的更多细节，可以通过看 Matt DeBergalis（Meteor 创始人之一）在 <a href="https://2012.realtimeconf.com/video/matt-debergalis" target="_blank" rel="external">Real-time 大会上的讲演视频</a>，或者来自 Chris Mather 的这个<a href="https://www.eventedmind.com/items/meteor-subscriptions-and-ddp" target="_blank" rel="external">截屏视频</a>，来学习关于这个概念更多的细节。</p>
 <pre>DDP
 distributed data protocol. the stateful websocket protocol.(under "Publish and subscribe", "Methods", and "Server connections")

 `ddp` can be configured to use a randomly generated subdomain for each long polling connection(Web browsers put a limit on the total number of HTTP connections that can be open to a particular domain at any one time, across all browser tabs.) 所谓 wire up(Mongo driver will automatically register with `ddp` to receive incoming data for `mycollection` and use it to keep `MyCollection` up to date.)

 特性：
 database driver integration
 automatic latency compensation（client's screen update instantly when they make changes 不用 wait for server round trip. 和 full-stack db drivers to snapshot and restore records??）
 transparent reconnect
 authentication (authentication hooks work great with Meteor Account.)
 input sanitization（audit-argument-checks， match's check）
 tracker-aware（connection status, subscription readiness, currently logged-in user 都是 reactive variables）
 default connect（meteor tools 构建会自动set up server, 这样就可以直接 meteor.subscribe，而不用 myconn = DPP.connect(url), myconn.subscribe 了）
 connection lifecycle hooks (当connection建立或关闭时，实现用户在线统计功能)
 CRUD bilerplate and quickstart packages （The `insecure` package turns off `allow`/`deny` rule checking for the generic `create`, `update`, and `delete` methods. The `autopublish` package automatically subscribes every connected client to the full contents of every database collection.）</pre>


<h3 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h3><p>假设有一个帖子列表页面，我们还希望可以通过固定链接访问到每个单独的帖子页面，URL 形式是 <a href="http://myapp.com/posts/xyz（这里的" target="_blank" rel="external">http://myapp.com/posts/xyz（这里的</a> xyz 是 MongoDB 的 _id 标识符），对于每个帖子来说是唯一的。这意味着我们需要某些路由来看看浏览器的地址栏里面的路径是什么，并相应地显示正确的内容。这就是 router 的作用。</p>
<h4 id="添加-Iron-Router-包"><a href="#添加-Iron-Router-包" class="headerlink" title="添加 Iron Router 包"></a>添加 Iron Router 包</h4><pre>meteor add iron:router</pre>

<h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><ul>
<li>路由规则（Route）：路由规则是路由的基本元素。它的工作就是当用户访问 App 的某个 URL 的时候，告诉 App 应该做什么，返回什么东西。</li>
<li>路径（Path）：路径是访问 App 的 URL。它可以是静态的（/terms_of_service）或者动态的（/posts/xyz），甚至还可以包含查询参数（- /search?keyword=meteor）。</li>
<li>目录（Segment）：路径的一部分，使用正斜杠（/）进行分隔。</li>
<li>Hooks：Hooks 是可以执行在路由之前，之后，甚至是路由正在进行的时候。一个典型的例子是，在显示一个页面之前检测用户是否拥有这个权限。</li>
<li>过滤器（Filter）：过滤器类似于 Hooks ，为一个或者多个路由规则定义的全局过滤器。</li>
<li>路由模板（Route Template）：每个路由规则指向的 Meteor 模板。如果你不指定，路由器将会默认去寻找一个具有相同名称的模板。</li>
<li>布局（Layout）：你可以想象成一个数码相框的布局。它们包含所有的 HTML 代码放置在当前的模板中，即使模板发生改变它们也不会变。</li>
<li>控制器（Controller）：有时候，你会发现很多你的模板都在重复使用一些参数。为了不重复你的代码，你可以让这些路由规则继承一个路由控制器（Routing Controller）去包含所有的路由逻辑。</li>
</ul>
<h4 id="路由：把-URL-映射到模板"><a href="#路由：把-URL-映射到模板" class="headerlink" title="路由：把 URL 映射到模板"></a>路由：把 URL 映射到模板</h4><p>默认情况下，Iron Router 会为路由规则，指定相同名字的模板。而如果路径（path 参数）没有指定，它也会根据路由规则的名字，去指定同样名字的路径。</p>
<p>你可能想知道为什么我们需要在一开始去制定路由规则。这是因为 Iron Router 的部分功能需要使用路由规则去生成 App 的链接信息。其中最常见的一个是  的 Spacebars helper，它需要返回路由规则的 URL 路径。</p>
<p>除了指定静态的 / URL ，我们还可以使用 Spacebars helper。虽然它们的效果是一样的，不过这给了我们更多的灵活性，如果我们更改了路由规则的映射路径，helper 仍然可以输出正确的 URL 。</p>
<h4 id="等待数据"><a href="#等待数据" class="headerlink" title="等待数据"></a>等待数据</h4><p>如果你要部署当前版本的 App（或启动起来去使用上面的链接），你会注意到在所有帖子完全出现之前，列表里面会空了一段时间。这是因为在第一次加载页面的时候，要等到 posts 订阅完成后，即从服务器抓取完帖子的数据，才能有帖子显示在页面上。</p>
<p>这应该要有一个更好的用户体验，比如提供一些视觉上的反馈让用户知道正在读取数据，这样用户才会去继续等待。Iron Router 给了我们一个简单的方法去实现它。我们把订阅放到 waitOn 的返回上。</p>
<h2 id="Meteor-部署"><a href="#Meteor-部署" class="headerlink" title="Meteor 部署"></a>Meteor 部署</h2><pre>meteor deploy myapp.meteor.com</pre>

<p>当然，你要把“myapp”替换成你想要的名称，最好是命名一个没有被使用的。如果你的名称已经被使用，Meteor 会提示你去输入密码。如果发生这样的情况，只需通过 ctrl+c 来取消当前操作，然后用另一个不同的名称再试一次。</p>
<p>如果顺利地部署成功了，几秒钟后你就能够在 <a href="http://myapp.meteor.com" target="_blank" rel="external">http://myapp.meteor.com</a> 上访问到你的应用了。</p>
<h1 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h1><h2 id="安装-meteorjs"><a href="#安装-meteorjs" class="headerlink" title="安装 meteorjs"></a>安装 meteorjs</h2><pre>$ curl https://install.meteor.com/ | sh</pre>

<h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><pre>
$ meteor create app_store
</pre>

<pre>
$ cd App-Recommender-System/
$ meteor
</pre>

<p>浏览器打开 <a href="http://localhost:3000/，就可以看到" target="_blank" rel="external">http://localhost:3000/，就可以看到</a> Meteor App 的状态。</p>
<h2 id="第三方-package"><a href="#第三方-package" class="headerlink" title="第三方 package"></a>第三方 package</h2><p>Add    three    packages:</p>
<ol>
<li>twbs:bootstrap - Twitter    Bootstrap    packaged     for    Meteor</li>
<li>iron:router – A    Meteor    package    that    handles    routing    between     pages</li>
<li>barbatus:stars-rating – A    small    library    to    give    us    nice    rating    stars    for    the    app    store.</li>
</ol>
<pre>meteor add iron:router twbs:bootstrap barbatus:stars-rating</pre>


<p>Remove    two    default    packages:</p>
<ol>
<li>autopublish – a    development    package    that    publishes    all    of    our    MongoDB data    to    the    client.        Great     for    prototyping,    insecure     for    production!        </li>
<li>insecure    – The    package    name    says    it    all.        This    package    allows    the    user    client     to    create,    update,    read    and    delete    any    data    in    our database.        It’s     another    package    meant     to    make    development     easier,    but    we    won’t    have    a    need     for    this    in    our    project.</li>
</ol>
<pre>meteor remove autopublish insecure</pre>


<h2 id="server"><a href="#server" class="headerlink" title="server"></a>server</h2><h3 id="Create-app-collection"><a href="#Create-app-collection" class="headerlink" title="Create app collection"></a>Create app collection</h3><p>新建 lib 文件夹，创建 apps.js 文件，添加如下代码</p>
<pre>Apps = new Meteor.Collection('apps');</pre>

<h3 id="Put-json-files"><a href="#Put-json-files" class="headerlink" title="Put json files"></a>Put json files</h3><p>这里衔接上一个部分 crawler 的工作，将我们保存在 MongoDB 的数据导出来放在 server 文件夹下。</p>
<pre>mongoexport -d appstore -c app_info -o ./app_info_new.json</pre>

<h3 id="Populate-app-collection"><a href="#Populate-app-collection" class="headerlink" title="Populate app collection"></a>Populate app collection</h3><p>server 文件夹下新建 fixures.js 来 load data.</p>
<pre>
// checks if app collection is empty so we don't call this code on every run
if(Apps.find({}).count() < 1){

    // read in json file using Npm filesystem package
    var fs = Npm.require('fs');
    fs.readFile('../../../../../server/app_info.json', 'utf8', Meteor.bindEnvironment(function(err, data) {
        if (err) throw err;
        var appData = data.split("\n");

        for (var i = 0; i < appData.length - 1; i++) {
            var rawAppData = JSON.parse(appData[i]);
            var app = {};

            app.name = rawAppData.title;
            app.app_id = rawAppData.app_id;
            app.developer = rawAppData.developer;
            app.description = rawAppData.intro;
            app.avgRating = parseInt(rawAppData.score) / 2;
            app.iconUrl = rawAppData.thumbnail_url;
            app.recommendedApps = rawAppData.top_5_app;
            app.numberOfRecommendations = 0;
            // insert app into collection
            Apps.insert(app);
        }

    }, function(err){
        throw err;
    }));
}
</pre>


<h3 id="Publish-app-collection"><a href="#Publish-app-collection" class="headerlink" title="Publish app collection"></a>Publish app collection</h3><p>server 文件夹下新建 publications.js 文件 publish data<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">/** returns all apps in the collection, takes an options object that is used to push</div><div class="line">sorting and filtering operations onto the server side, this publication will be used</div><div class="line">in top charts list*/</div><div class="line">Meteor.publish(&apos;apps&apos;,function(options)&#123;</div><div class="line">  return Apps.find(&#123;&#125;,options);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">/** takes an appid as a parameter and returns just one app that matches the appid,</div><div class="line">this publication will be used by our app details page for a single app */</div><div class="line">Meteor.publish(&apos;singleApp&apos;,function(id)&#123;</div><div class="line">  return Apps.find(&#123;_id:id&#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">/** this publication will be used to look up the recommended apps*/</div><div class="line">Meteor.publish(&apos;singleAppByAppId&apos;,function(appId)&#123;</div><div class="line">  return Apps.find(&#123;app_id:appId&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="client"><a href="#client" class="headerlink" title="client"></a>client</h2><h3 id="新建-index-html-文件"><a href="#新建-index-html-文件" class="headerlink" title="新建 index.html 文件"></a>新建 index.html 文件</h3><p>在 client 目录下新建 index.html 文件。添加 head，meteor 的 Blaze template engine 会产生 body。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;head&gt;</div><div class="line">  &lt;title&gt;App Store&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line"></div><div class="line">&lt;body&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure></p>
<h3 id="添加-css-文件"><a href="#添加-css-文件" class="headerlink" title="添加 css 文件"></a>添加 css 文件</h3><p>这里就不贴代码了</p>
<h3 id="Tell-iron-router-where-to-rend-templates"><a href="#Tell-iron-router-where-to-rend-templates" class="headerlink" title="Tell iron:router where to rend templates"></a>Tell iron:router where to rend templates</h3><p>在 layouts 里新建 master_layout.html 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;template name=&quot;masterLayout&quot;&gt;</div><div class="line"></div><div class="line">    &lt;div class=&quot;container&quot;&gt;</div><div class="line">        &lt;div class=&quot;row&quot;&gt;</div><div class="line">            &lt;div class=&quot;col-md-4 col-md-offset-4 col-sm-12 col-xs-12 mainContainer&quot;&gt;</div><div class="line">                 &#123;&#123;&gt; yield &#125;&#125; &lt;!-- tells iron:router where to render our view templates inside of this layout--&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line"></div><div class="line">&lt;/template&gt;</div></pre></td></tr></table></figure></p>
<h3 id="topChart-template"><a href="#topChart-template" class="headerlink" title="topChart template"></a>topChart template</h3><p>新建 views 文件夹，新建 topChart.html 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;!-- define a template named topChart --&gt;</div><div class="line">&lt;template name=&quot;topChart&quot;&gt;</div><div class="line">  &lt;!-- utilize the bootstrap navbar class to give us the App	Store	top	bar --&gt;</div><div class="line">    &lt;nav class=&quot;navbar navbar-default&quot;&gt;</div><div class="line">        &lt;div class=&quot;container-fluid&quot;&gt;</div><div class="line">            &lt;div class=&quot;text-center&quot; id=&quot;navTitle&quot;&gt;</div><div class="line">                &lt;strong&gt;Top Charts&lt;/strong&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/nav&gt;</div><div class="line">&lt;/template&gt;</div></pre></td></tr></table></figure></p>
<h3 id="为-topChart-template-填充数据"><a href="#为-topChart-template-填充数据" class="headerlink" title="为 topChart template 填充数据"></a>为 topChart template 填充数据</h3><p>之前我们加了 “iron:router” 包，用这个包，我们可以提供一个得到 topChart template 的路径，为这个 template 设置数据<br>在 lib 下新建 routing 文件夹，添加 router.js 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Router.configure(&#123;</div><div class="line">    // tell iron router to render our individual templates inside of our masterLayout template</div><div class="line">    layoutTemplate: &quot;masterLayout&quot;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Router.route(&apos;/&apos;, &#123;// describe the route path, &apos;/&apos; - root path of our web app</div><div class="line">    name: &apos;topChart&apos;,// the template this route will use</div><div class="line">    waitOn: function() &#123;</div><div class="line">      // iron router will hold off rendering our page until the waitOn function completes</div><div class="line">      // returns a subscription to our “apps” publication</div><div class="line">      // passes	a	set	of options to	the	server,</div><div class="line">      // tells	the	server	to	sort	our	apps	based	off	of	avgRating and	app_id.	And	to only	give us	a	max	of	20	results.</div><div class="line">        Meteor.subscribe(&apos;apps&apos;, &#123;sort: &#123;avgRating: -1, app_id: -1&#125;, limit: 50&#125;);</div><div class="line">    &#125;,</div><div class="line">    // The return	value	of the data function becomes the Blaze template’s	“data	context”.</div><div class="line">    // returns an	object with	a	single property	“apps” that	contains all the Apps returned via	our	subscription.</div><div class="line">    data: function () &#123;</div><div class="line">        return &#123;</div><div class="line">            apps: Apps.find(&#123;&#125;, &#123;sort: &#123;avgRating: -1, app_id: -1&#125;, limit: 50&#125;)</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="更新-topChart-html-文件"><a href="#更新-topChart-html-文件" class="headerlink" title="更新 topChart.html 文件"></a>更新 topChart.html 文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;ul class=&quot;list-group&quot;&gt;</div><div class="line">  &lt;!-- use the built in SpaceBars &#123;&#123;#each&#125;&#125;	to iterate through the “apps” property that	we set inside	our	route’s	”data”	function.</div><div class="line">  Inside the	&#123;&#123;#each&#125;&#125;&#123;&#123;/each&#125;&#125; block the data context	changes	from “apps”	to be	the	app	in scope for each	iteration.--&gt;</div><div class="line">    &#123;&#123;#each apps&#125;&#125;</div><div class="line">    &lt;!-- call	the	“appPreview” template. Since it	is inside	the	&#123;&#123;#each&#125;&#125;	block	it will	be passed	the	data for each	individual	app	as	its</div><div class="line">    context	as we	iterate	through	our	parent data	context. --&gt;</div><div class="line">        &#123;&#123;&gt; appPreview this&#125;&#125;</div><div class="line">    &#123;&#123;/each&#125;&#125;</div><div class="line">&lt;/ul&gt;</div></pre></td></tr></table></figure>
<h3 id="appPreview-template"><a href="#appPreview-template" class="headerlink" title="appPreview template"></a>appPreview template</h3><p>views 里添加 appPreview.html 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;template name=&quot;appPreview&quot;&gt;</div><div class="line">  &lt;!-- each app preview will be wrapped in an &lt;li&gt; element, as the topChart template will insert each app into a &lt;ul&gt;--&gt;</div><div class="line">    &lt;li class=&quot;list-group-item&quot;&gt;</div><div class="line">        &lt;div class=&quot;row&quot;&gt;</div><div class="line">            &lt;div class=&quot;col-xs-1 appRank text-muted&quot;&gt;</div><div class="line">                &#123;&#123;rank&#125;&#125;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;!-- set the img src to the iconUrl property that we scraped--&gt;</div><div class="line">            &lt;div class=&quot;col-xs-3 appIconPreview&quot;&gt;</div><div class="line">                &lt;img height=50 width=50 src=&quot;&#123;&#123;iconUrl&#125;&#125;&quot;/&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div class=&quot;col-xs-6 nameColumn&quot;&gt;</div><div class="line">                &lt;a href=&quot;&#123;&#123;pathFor &apos;appPage&apos;&#125;&#125;&quot;&gt;&#123;&#123;name&#125;&#125;&lt;/a&gt;&lt;br/&gt;</div><div class="line">                &lt;div style=&quot;display:flex&quot;&gt;</div><div class="line">                  &lt;!-- the stars-rating package with this template. pass apps avgRating property to the templates &quot;rating&quot; property</div><div class="line">                        so that it can color the correct # of stars--&gt;</div><div class="line">                    &#123;&#123;&gt; starsRating rating=avgRating class=&apos;mystar&apos; size=&apos;sm&apos;&#125;&#125;</div><div class="line">                &lt;/div&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div class=&quot;col-xs-2 text-right getApp&quot;&gt;</div><div class="line">              &lt;!-- pathFor is a built in helper that takes the name of the route and returns a correct path. --&gt;</div><div class="line">                &lt;a href=&quot;&#123;&#123;pathFor &apos;appPage&apos;&#125;&#125;&quot; class=&quot;btn btn-primary&quot;&gt;+ Get&lt;/a&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/li&gt;</div><div class="line">&lt;/template&gt;</div></pre></td></tr></table></figure></p>
<h3 id="appPage-template"><a href="#appPage-template" class="headerlink" title="appPage template"></a>appPage template</h3><p>和上面是同样的道理，在 views 里添加 appPage.html 文件，然后为 appPage template 填充数据，不同的是这里多了中间一步，通过遍历 recommendedApps，我们只能从数据库里得到 recommended app 的 appid, 然而并没有 data context，也就是说，我们还需要有一个 template helper 来设置 recommended apps 的 data context，所以需要新建一个 appPage.js 文件来完成这个工作。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">// Template.&#123;&#123;templateName&#125;&#125;.helpers() takes a JSON	object where the keys are the name of hte helper function</div><div class="line">// these functions can be called directly from a blaze template</div><div class="line">Template.appPage.helpers(&#123;</div><div class="line">    getSuggestedApp: function(appId) &#123;</div><div class="line">      // use singleAppByAppId subscription, then use Apps.findOne() to retrieve the app object and return it to our	Blaze</div><div class="line">      // template, the pass the object to suggestedApp templates as the data context</div><div class="line">        Meteor.subscribe(&apos;singleAppByAppId&apos;, appId);</div><div class="line">        return Apps.findOne(&#123;app_id: appId&#125;);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">// attach JQuerystyle event listeners on a template by passing a json object to Template.&#123;&#123;templateName&#125;&#125;.events().</div><div class="line">// the key here is the event type(click in this case) followed by the CSS selecter(#backLink in this case)</div><div class="line">// values are the functions	to be executed on event click. here we are using a feature of iron router “history.back()” to</div><div class="line">// bring us back to the previous page</div><div class="line">Template.appPage.events(&#123;</div><div class="line">    &quot;click #backLink&quot; : function(evt) &#123;</div><div class="line">        history.back();</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>之后再修改 routers.js 文件，加上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Router.route(&apos;/app/:_id&apos;, &#123;//’:’ tells Iron	Router that this is a variable that will be bound to the _id parameter</div><div class="line">    name: &apos;appPage&apos;,</div><div class="line">    waitOn: function() &#123;</div><div class="line">      // pass the app id passed in the url by using this.params._id</div><div class="line">        Meteor.subscribe(&apos;singleApp&apos;, this.params._id);</div><div class="line">    &#125;,</div><div class="line">    data: function () &#123;</div><div class="line">      // bind the app with the given id to the data context of template</div><div class="line">        return Apps.findOne(this.params._id);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="运行效果"><a href="#运行效果" class="headerlink" title="运行效果"></a>运行效果</h2><p><img src="http://7xu83c.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-07%20%E4%B8%8A%E5%8D%8810.38.31.png" alt=""></p>
<p><img src="http://7xu83c.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-07%20%E4%B8%8B%E5%8D%886.03.40.png" alt=""></p>
<p><a href="https://github.com/Shuang0420/App-Recommender-System/tree/master/app_store" target="_blank" rel="external">代码</a></p>
<blockquote>
<p>参考链接<br><br><a href="http://zh.discovermeteor.com/pdf" target="_blank" rel="external">DISCOVER METEOR</a><br></p>
</blockquote>

      
    </div>

    <div>
      
        
<div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat.jpg" alt="徐阿衡 wechat" style="width: 200px; max-width: 100%;"/>
    <div>欢迎关注：徐阿衡的微信公众号</div>
</div>


      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>客官，打个赏呗~</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://7xu83c.com1.z0.glb.clouddn.com/1.pic.jpg" alt="徐阿衡 WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Crawler/" rel="tag">#Crawler</a>
          
            <a href="/tags/Meteor/" rel="tag">#Meteor</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/07/05/项目实战--云计算Social Networking Timeline/" rel="next" title="项目实战--云计算Social Networking Timeline">
                <i class="fa fa-chevron-left"></i> 项目实战--云计算Social Networking Timeline
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/07/10/Tfidf总结笔记/" rel="prev" title="Tf-idf 总结笔记">
                Tf-idf 总结笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      



    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
     
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://7xu83c.com1.z0.glb.clouddn.com/2.pic.jpg"
               alt="徐阿衡" />
          <p class="site-author-name" itemprop="name">徐阿衡</p>
          <p class="site-description motion-element" itemprop="description">读万卷书，行万里路 @SYSU @CMU</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">166</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">126</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Shuang0420" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.linkedin.com/in/shuang-xu-7008b894?trk=nav_responsive_tab_profile_pic" target="_blank" title="LinkedIn">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  LinkedIn
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://zhuanlan.zhihu.com/c_136690664" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://starllap.space" title="Star" target="_blank">Star</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://liam0205.me" title="Liam Huang" target="_blank">Liam Huang</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.libinx.com" title="Li Bin" target="_blank">Li Bin</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#基础"><span class="nav-number">1.</span> <span class="nav-text">基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Meteor-的创新"><span class="nav-number">1.1.</span> <span class="nav-text">Meteor 的创新</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meteor-特点"><span class="nav-number">1.2.</span> <span class="nav-text">Meteor 特点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meteor-结构"><span class="nav-number">1.3.</span> <span class="nav-text">Meteor 结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Meteor-文件规则"><span class="nav-number">1.3.1.</span> <span class="nav-text">Meteor 文件规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Meteor-加载文件顺序"><span class="nav-number">1.3.2.</span> <span class="nav-text">Meteor 加载文件顺序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meteor-核心概念"><span class="nav-number">1.4.</span> <span class="nav-text">Meteor 核心概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#模板系统-Spacebars"><span class="nav-number">1.4.1.</span> <span class="nav-text">模板系统 Spacebars</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#collection"><span class="nav-number">1.4.2.</span> <span class="nav-text">collection</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#服务器端"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">服务器端</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#客户端"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">客户端</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#客户端-服务器通讯"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">客户端-服务器通讯</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#发布（Publication）和订阅（Subscription）"><span class="nav-number">1.4.3.</span> <span class="nav-text">发布（Publication）和订阅（Subscription）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#发布"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">发布</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#订阅"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">订阅</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DDP"><span class="nav-number">1.4.3.3.</span> <span class="nav-text">DDP</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Router"><span class="nav-number">1.4.4.</span> <span class="nav-text">Router</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#添加-Iron-Router-包"><span class="nav-number">1.4.4.1.</span> <span class="nav-text">添加 Iron Router 包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#基本概念"><span class="nav-number">1.4.4.2.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#路由：把-URL-映射到模板"><span class="nav-number">1.4.4.3.</span> <span class="nav-text">路由：把 URL 映射到模板</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#等待数据"><span class="nav-number">1.4.4.4.</span> <span class="nav-text">等待数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meteor-部署"><span class="nav-number">1.5.</span> <span class="nav-text">Meteor 部署</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#实例"><span class="nav-number">2.</span> <span class="nav-text">实例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装-meteorjs"><span class="nav-number">2.1.</span> <span class="nav-text">安装 meteorjs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建项目"><span class="nav-number">2.2.</span> <span class="nav-text">创建项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三方-package"><span class="nav-number">2.3.</span> <span class="nav-text">第三方 package</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#server"><span class="nav-number">2.4.</span> <span class="nav-text">server</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-app-collection"><span class="nav-number">2.4.1.</span> <span class="nav-text">Create app collection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Put-json-files"><span class="nav-number">2.4.2.</span> <span class="nav-text">Put json files</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Populate-app-collection"><span class="nav-number">2.4.3.</span> <span class="nav-text">Populate app collection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Publish-app-collection"><span class="nav-number">2.4.4.</span> <span class="nav-text">Publish app collection</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#client"><span class="nav-number">2.5.</span> <span class="nav-text">client</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#新建-index-html-文件"><span class="nav-number">2.5.1.</span> <span class="nav-text">新建 index.html 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加-css-文件"><span class="nav-number">2.5.2.</span> <span class="nav-text">添加 css 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tell-iron-router-where-to-rend-templates"><span class="nav-number">2.5.3.</span> <span class="nav-text">Tell iron:router where to rend templates</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#topChart-template"><span class="nav-number">2.5.4.</span> <span class="nav-text">topChart template</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为-topChart-template-填充数据"><span class="nav-number">2.5.5.</span> <span class="nav-text">为 topChart template 填充数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#更新-topChart-html-文件"><span class="nav-number">2.5.6.</span> <span class="nav-text">更新 topChart.html 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#appPreview-template"><span class="nav-number">2.5.7.</span> <span class="nav-text">appPreview template</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#appPage-template"><span class="nav-number">2.5.8.</span> <span class="nav-text">appPage template</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#运行效果"><span class="nav-number">2.6.</span> <span class="nav-text">运行效果</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <!-- Other code may be here -->
<div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">徐阿衡</span>
  <a href="http://www.miitbeian.gov.cn/">粤ICP备17129486号</a>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>


<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'httpshuang0420githubio';
      var disqus_identifier = '2016/07/07/Meteor-App-Recommender-System/';
      var disqus_title = "Meteor--App_Recommender_System";
      var disqus_url = 'http://www.shuang0420.com/2016/07/07/Meteor-App-Recommender-System/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>
</html>
