<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />













  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Crawler," />





  <link rel="alternate" href="/atom.xml" title="å¾é˜¿è¡¡" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.3" />






<meta name="description" content="åˆ†å¸ƒå¼çˆ¬è™«çš„æ¼”ä¹ ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="çˆ¬è™«æ€»ç»“(å››)-- åˆ†å¸ƒå¼çˆ¬è™«">
<meta property="og:url" content="http://www.shuang0420.com/2016/06/17/çˆ¬è™«æ€»ç»“-å››-åˆ†å¸ƒå¼çˆ¬è™«/index.html">
<meta property="og:site_name" content="å¾é˜¿è¡¡">
<meta property="og:description" content="åˆ†å¸ƒå¼çˆ¬è™«çš„æ¼”ä¹ ã€‚">
<meta property="og:image" content="http://7xu83c.com1.z0.glb.clouddn.com/scheduler.png">
<meta property="og:updated_time" content="2018-09-17T11:14:29.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="çˆ¬è™«æ€»ç»“(å››)-- åˆ†å¸ƒå¼çˆ¬è™«">
<meta name="twitter:description" content="åˆ†å¸ƒå¼çˆ¬è™«çš„æ¼”ä¹ ã€‚">
<meta name="twitter:image" content="http://7xu83c.com1.z0.glb.clouddn.com/scheduler.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '6294135991397516000',
      author: 'é˜¿è¡¡'
    }
  };
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6146435155426457",
    enable_page_level_ads: true
  });
</script>




  <link rel="canonical" href="http://www.shuang0420.com/2016/06/17/çˆ¬è™«æ€»ç»“-å››-åˆ†å¸ƒå¼çˆ¬è™«/"/>


  <title> çˆ¬è™«æ€»ç»“(å››)-- åˆ†å¸ƒå¼çˆ¬è™« | å¾é˜¿è¡¡ </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="en">

  










  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">å¾é˜¿è¡¡</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Shuang</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-works">
          <a href="/works" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Works
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/aboutme" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input" placeholder="search my blog...">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
         
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                çˆ¬è™«æ€»ç»“(å››)-- åˆ†å¸ƒå¼çˆ¬è™«
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-17T10:45:12+08:00" content="2016-06-17">
              2016-06-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/NLP/" itemprop="url" rel="index">
                    <span itemprop="name">NLP</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/NLP/Crawler/" itemprop="url" rel="index">
                    <span itemprop="name">Crawler</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/17/çˆ¬è™«æ€»ç»“-å››-åˆ†å¸ƒå¼çˆ¬è™«/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/17/çˆ¬è™«æ€»ç»“-å››-åˆ†å¸ƒå¼çˆ¬è™«/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
              &nbsp; | &nbsp;
              <span class="page-pv"><i class="fa fa-file-o"></i>
              <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
              </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>åˆ†å¸ƒå¼çˆ¬è™«çš„æ¼”ä¹ ã€‚<br><a id="more"></a><br>åˆ†å¸ƒå¼çˆ¬è™«é—®é¢˜å…¶å®ä¹Ÿå°±æ˜¯å¤šå°æœºå™¨å¤šä¸ª spider å¯¹ å¤šä¸ª url çš„åŒæ—¶å¤„ç†é—®é¢˜ï¼Œæ€æ · schedule è¿™äº› urlï¼Œæ€æ ·æ±‡æ€» spider æŠ“å–çš„æ•°æ®ã€‚æœ€ç®€å•ç²—æš´çš„æ–¹æ³•å°±æ˜¯å°† url è¿›è¡Œåˆ†ç‰‡ï¼Œäº¤ç»™ä¸åŒæœºå™¨ï¼Œæœ€åå¯¹ä¸åŒæœºå™¨æŠ“å–çš„æ•°æ®è¿›è¡Œæ±‡æ€»ã€‚ç„¶è€Œè¿™æ ·æ¯ä¸ª spider åªèƒ½å¯¹è‡ªå·±å¤„ç†çš„ url å»é‡ï¼Œæ²¡åŠæ³•å…¨å±€çš„å»é‡ï¼Œå¦å¤–æ€§èƒ½ä¹Ÿå¾ˆéš¾æ§åˆ¶ï¼Œå¯èƒ½æœ‰æŸå°æœºå™¨å¾ˆæ—©å°±è·‘å®Œäº†ï¼Œè€Œåˆ«çš„æœºå™¨è¿˜è¦è·‘å¾ˆä¹…ã€‚å¦ä¸€ç§æ€è·¯å°±æ˜¯æŠŠ url å­˜åœ¨æŸä¸ªåœ°æ–¹ï¼Œå…±äº«ç»™æ‰€æœ‰çš„æœºå™¨ï¼Œæ€»çš„è°ƒåº¦å™¨æ¥åˆ†é…è¯·æ±‚ï¼Œåˆ¤æ–­ spider æœ‰æ²¡æœ‰é—²ç½®ï¼Œé—²ç½®äº†å°±ç»§ç»­ç»™å®ƒä»»åŠ¡ï¼Œç›´åˆ°æ‰€æœ‰çš„ url éƒ½çˆ¬å®Œï¼Œè¿™ç§æ–¹æ³•è§£å†³äº†å»é‡é—®é¢˜ï¼ˆä¸‹é¢ä¼šå…·ä½“è®²åˆ°ï¼‰ï¼Œä¹Ÿèƒ½æé«˜æ€§èƒ½ï¼Œscrapy-redis å°±å®ç°äº†è¿™æ ·ä¸€ä¸ªå®Œæ•´æ¡†æ¶ï¼Œæ€»çš„æ¥è¯´ï¼Œè¿™æ›´é€‚åˆå¹¿åº¦ä¼˜å…ˆçš„çˆ¬å–ã€‚</p>
<h1 id="Scrapyd"><a href="#Scrapyd" class="headerlink" title="Scrapyd"></a>Scrapyd</h1><p>Scrapy å¹¶æ²¡æœ‰æä¾›å†…ç½®çš„åˆ†å¸ƒå¼æŠ“å–åŠŸèƒ½ï¼Œä¸è¿‡æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å¸®ä½ å®ç°ã€‚</p>
<p>å¦‚æœä½ æœ‰å¾ˆå¤šä¸ªspiderï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯å¯åŠ¨å¤šä¸ª Scrapyd å®ä¾‹ï¼Œç„¶åå°†spideråˆ†å¸ƒåˆ°å„ä¸ªæœºå™¨ä¸Šé¢ã€‚</p>
<p>å¦‚æœä½ æƒ³å¤šä¸ªæœºå™¨è¿è¡ŒåŒä¸€ä¸ªspiderï¼Œå¯ä»¥å°†urlåˆ†ç‰‡åäº¤ç»™æ¯ä¸ªæœºå™¨ä¸Šé¢çš„spiderã€‚æ¯”å¦‚ä½ æŠŠURLåˆ†æˆ3ä»½</p>
<pre>
http://somedomain.com/urls-to-crawl/spider1/part1.list
http://somedomain.com/urls-to-crawl/spider1/part2.list
http://somedomain.com/urls-to-crawl/spider1/part3.list</pre>

<p>ç„¶åè¿è¡Œ3ä¸ª Scrapyd å®ä¾‹ï¼Œåˆ†åˆ«å¯åŠ¨å®ƒä»¬ï¼Œå¹¶ä¼ é€’partå‚æ•°</p>
<pre>
curl http://scrapy1.mycompany.com:6800/schedule.json -d project=myproject -d spider=spider1 -d part=1
curl http://scrapy2.mycompany.com:6800/schedule.json -d project=myproject -d spider=spider1 -d part=2
curl http://scrapy3.mycompany.com:6800/schedule.json -d project=myproject -d spider=spider1 </pre>


<h1 id="Crawlera"><a href="#Crawlera" class="headerlink" title="Crawlera"></a>Crawlera</h1><p>è¿™ä¸ªï¼ŒèŠ±é’±å°±å¯ä»¥è½»æ˜“è§£å†³ï½ <a href="http://doc.scrapinghub.com/crawlera.html" target="_blank" rel="external">ç›´è¾¾</a></p>
<h1 id="Scrapy-redis"><a href="#Scrapy-redis" class="headerlink" title="Scrapy-redis"></a>Scrapy-redis</h1><p>Redis æ˜¯é«˜æ€§èƒ½çš„ key-value æ•°æ®åº“ã€‚æˆ‘ä»¬çŸ¥é“ MongoDB å°†æ•°æ®ä¿å­˜åœ¨äº†ç¡¬ç›˜é‡Œï¼Œè€Œ Redis çš„ç¥å¥‡ä¹‹å¤„åœ¨äºå®ƒå°†æ•°æ®ä¿å­˜åœ¨äº†å†…å­˜ä¸­ï¼Œå› æ­¤å¸¦æ¥äº†æ›´é«˜çš„æ€§èƒ½ã€‚</p>
<h2 id="åˆ†å¸ƒå¼åŸç†"><a href="#åˆ†å¸ƒå¼åŸç†" class="headerlink" title="åˆ†å¸ƒå¼åŸç†"></a>åˆ†å¸ƒå¼åŸç†</h2><p>scrapy-rediså®ç°åˆ†å¸ƒå¼ï¼Œå…¶å®ä»åŸç†ä¸Šæ¥è¯´å¾ˆç®€å•ï¼Œè¿™é‡Œä¸ºæè¿°æ–¹ä¾¿ï¼Œæˆ‘ä»¬æŠŠè‡ªå·±çš„æ ¸å¿ƒæœåŠ¡å™¨ç§°ä¸º masterï¼Œè€ŒæŠŠç”¨äºè·‘çˆ¬è™«ç¨‹åºçš„æœºå™¨ç§°ä¸º slaveã€‚</p>
<p>å›é¡¾ <a href="http://www.shuang0420.com/2016/06/12/çˆ¬è™«æ€»ç»“-äºŒ-scrapy/">scrapy æ¡†æ¶</a>ï¼Œæˆ‘ä»¬é¦–å…ˆç»™å®šä¸€äº›start_urlsï¼Œspider æœ€å…ˆè®¿é—® start_urls é‡Œé¢çš„ urlï¼Œå†æ ¹æ®æˆ‘ä»¬çš„ parse å‡½æ•°ï¼Œå¯¹é‡Œé¢çš„å…ƒç´ ã€æˆ–è€…æ˜¯å…¶ä»–çš„äºŒçº§ã€ä¸‰çº§é¡µé¢è¿›è¡ŒæŠ“å–ã€‚è€Œè¦å®ç°åˆ†å¸ƒå¼ï¼Œåªéœ€è¦åœ¨è¿™ä¸ªstarts_urlsé‡Œé¢åšæ–‡ç« å°±è¡Œäº†ã€‚è¿›ä¸€æ­¥æè¿°å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>master äº§ç”Ÿ starts_urlsï¼Œurl ä¼šè¢«å°è£…æˆ request æ”¾åˆ° redis ä¸­çš„ spider:requestsï¼Œæ€»çš„ scheduler ä¼šä»è¿™é‡Œåˆ†é… requestï¼Œå½“è¿™é‡Œçš„ request åˆ†é…å®Œåï¼Œä¼šç»§ç»­åˆ†é… start_urls é‡Œçš„ urlã€‚</p>
</li>
<li><p>slave ä» master çš„ redis ä¸­å–å‡ºå¾…æŠ“å–çš„ requestï¼Œä¸‹è½½å®Œç½‘é¡µä¹‹åå°±æŠŠç½‘é¡µçš„å†…å®¹å‘é€å› master çš„ redisï¼Œkey æ˜¯ spider:itemsã€‚scrapy å¯ä»¥é€šè¿‡ settings æ¥è®© spider çˆ¬å–ç»“æŸä¹‹åä¸è‡ªåŠ¨å…³é—­ï¼Œè€Œæ˜¯ä¸æ–­çš„å»è¯¢é—®é˜Ÿåˆ—é‡Œæœ‰æ²¡æœ‰æ–°çš„ urlï¼Œå¦‚æœæœ‰æ–°çš„ urlï¼Œé‚£ä¹ˆç»§ç»­è·å– url å¹¶è¿›è¡Œçˆ¬å–ï¼Œæ‰€ä»¥è¿™ä¸€è¿‡ç¨‹å°†ä¸æ–­å¾ªç¯ã€‚</p>
</li>
<li><p>master é‡Œçš„ reids è¿˜æœ‰ä¸€ä¸ª key æ˜¯ â€œspider:dupefilterâ€ ç”¨æ¥å­˜å‚¨æŠ“å–è¿‡çš„ url çš„ fingerprintï¼ˆä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†urlè¿ç®—åçš„ç»“æœï¼‰ï¼Œé˜²æ­¢é‡å¤æŠ“å–ï¼Œåªè¦ redis ä¸æ¸…ç©ºï¼Œå°±å¯ä»¥è¿›è¡Œæ–­ç‚¹ç»­çˆ¬ã€‚</p>
</li>
</ol>
<p>å¯¹äºå·²æœ‰çš„ scrapy ç¨‹åºï¼Œå¯¹å…¶æ‰©å±•æˆåˆ†å¸ƒå¼ç¨‹åºè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ã€‚æ€»çš„æ¥è¯´å°±æ˜¯ä»¥ä¸‹å‡ æ­¥ï¼š</p>
<ol>
<li>æ‰¾ä¸€å°é«˜æ€§èƒ½æœåŠ¡å™¨ï¼Œç”¨äº redis é˜Ÿåˆ—çš„ç»´æŠ¤ä»¥åŠæ•°æ®çš„å­˜å‚¨ã€‚</li>
<li>æ‰©å±• scrapy ç¨‹åºï¼Œè®©å…¶é€šè¿‡æœåŠ¡å™¨çš„ redis æ¥è·å– start_urlsï¼Œå¹¶æ”¹å†™ pipeline é‡Œæ•°æ®å­˜å‚¨éƒ¨åˆ†ï¼ŒæŠŠå­˜å‚¨åœ°å€æ”¹ä¸ºæœåŠ¡å™¨åœ°å€ã€‚</li>
<li>åœ¨æœåŠ¡å™¨ä¸Šå†™ä¸€äº›ç”Ÿæˆurlçš„è„šæœ¬ï¼Œå¹¶å®šæœŸæ‰§è¡Œã€‚</li>
</ol>
<p>å…³äº scheduler åˆ°åº•æ˜¯æ€ä¹ˆè¿›è¡Œè°ƒåº¦çš„ï¼Œéœ€è¦çœ‹æºç è¿›è¡Œåˆ†æã€‚</p>
<h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><p>å¯èƒ½ä¸Šé¢çš„æè¿°è¿˜æ˜¯ä¸å¤Ÿæ¸…æ¥šï¼Œå¹²è„†çœ‹ä¸€ä¸‹æºç å§ï¼Œscrapy-redis ä¸»è¦è¦ä¸€ä¸‹å‡ ä¸ªæ–‡ä»¶ã€‚</p>
<h3 id="é›¶ä»¶åˆ†æ"><a href="#é›¶ä»¶åˆ†æ" class="headerlink" title="é›¶ä»¶åˆ†æ"></a>é›¶ä»¶åˆ†æ</h3><ol>
<li><p>connection.py<br>æ ¹æ® settings é‡Œçš„é…ç½®å®ä¾‹åŒ– redis è¿æ¥ï¼Œè¢« dupefilter å’Œ scheduler è°ƒç”¨ã€‚</p>
</li>
<li><p>dupefilter.py<br>å¯¹ request è¿›è¡Œå»é‡ï¼Œä½¿ç”¨äº† redis çš„ setã€‚</p>
</li>
<li><p>queue.py<br>ä¸‰ç§ queue, SpiderQueueï¼ˆFIFO), SpiderPriorityQueueï¼Œä»¥åŠ SpiderStack(LIFI)ã€‚é»˜è®¤ä½¿ç”¨çš„æ˜¯ç¬¬äºŒç§ã€‚</p>
</li>
<li><p>pipelines.py<br>åˆ†å¸ƒå¼å¤„ç†ï¼Œå°† item å­˜å‚¨åœ¨ redis ä¸­ã€‚</p>
</li>
<li><p>scheduler.py<br>å–ä»£ scrapy è‡ªå¸¦çš„ scheduler,å®ç°åˆ†å¸ƒå¼è°ƒåº¦ï¼Œæ•°æ®ç»“æ„æ¥è‡ª queueã€‚</p>
</li>
<li><p>spider.py<br>å®šä¹‰ RedisSpider.py, ç»§æ‰¿äº† RedisMixin å’Œ CrawlSpiderã€‚</p>
</li>
</ol>
<p>ç”±ä¸Šå¯çŸ¥ï¼Œscrapy-redis å®ç°çš„ <strong>çˆ¬è™«åˆ†å¸ƒå¼</strong> å’Œ <strong>itemå¤„ç†åˆ†å¸ƒå¼</strong> å°±æ˜¯ç”±æ¨¡å— scheduler å’Œæ¨¡å— pipelines å®ç°ã€‚ä¸Šè¿°å…¶å®ƒæ¨¡å—ä½œä¸ºä¸ºäºŒè€…è¾…åŠ©çš„åŠŸèƒ½æ¨¡å—ã€‚</p>
<h3 id="è°ƒåº¦è¿‡ç¨‹"><a href="#è°ƒåº¦è¿‡ç¨‹" class="headerlink" title="è°ƒåº¦è¿‡ç¨‹"></a>è°ƒåº¦è¿‡ç¨‹</h3><h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><p>spider è¢«åˆå§‹åŒ–æ—¶ï¼ŒåŒæ—¶ä¼šåˆå§‹åŒ–ä¸€ä¸ªå¯¹åº”çš„ scheduler å¯¹è±¡ï¼Œè¿™ä¸ªè°ƒåº¦å™¨å¯¹è±¡é€šè¿‡è¯»å– settingsï¼Œé…ç½®å¥½è‡ªå·±çš„è°ƒåº¦å®¹å™¨ queue å’Œåˆ¤é‡å·¥å…·dupefilterã€‚</p>
<h4 id="åˆ¤é‡-amp-è¿›å…¥è°ƒåº¦æ± "><a href="#åˆ¤é‡-amp-è¿›å…¥è°ƒåº¦æ± " class="headerlink" title="åˆ¤é‡ &amp; è¿›å…¥è°ƒåº¦æ± "></a>åˆ¤é‡ &amp; è¿›å…¥è°ƒåº¦æ± </h4><p>æ¯å½“ä¸€ä¸ª spider äº§å‡ºä¸€ä¸ª request çš„æ—¶å€™ï¼Œscrapy å†…æ ¸ä¼šæŠŠè¿™ä¸ª request é€’äº¤ç»™è¿™ä¸ª spider å¯¹åº”çš„ scheduler å¯¹è±¡è¿›è¡Œè°ƒåº¦ï¼Œscheduler å¯¹è±¡é€šè¿‡è®¿é—® redis å¯¹ request è¿›è¡Œåˆ¤é‡ï¼Œå¦‚æœä¸é‡å¤å°±æŠŠä»–æ·»åŠ è¿› redis ä¸­çš„è°ƒåº¦æ± ã€‚</p>
<h4 id="è°ƒåº¦"><a href="#è°ƒåº¦" class="headerlink" title="è°ƒåº¦"></a>è°ƒåº¦</h4><p>å½“è°ƒåº¦æ¡ä»¶æ»¡è¶³æ—¶ï¼Œscheduler å¯¹è±¡å°±ä» redis çš„è°ƒåº¦æ± ä¸­å–å‡ºä¸€ä¸ª request å‘é€ç»™spiderï¼Œè®© spider çˆ¬å–ï¼Œè‹¥çˆ¬å–è¿‡ç¨‹ä¸­è¿”å›æ›´å¤šçš„urlï¼Œé‚£ä¹ˆç»§ç»­è¿›è¡Œç›´è‡³æ‰€æœ‰çš„ request å®Œæˆã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­é€šè¿‡ connect signals.spider_idle ä¿¡å·å¯¹ crawler çŠ¶æ€çš„ç›‘è§†ï¼Œscheduler å¯¹è±¡å‘ç° è¿™ä¸ª spider çˆ¬å–äº†æ‰€æœ‰æš‚æ—¶å¯ç”¨ urlï¼Œå¯¹åº”çš„ redis çš„è°ƒåº¦æ± ç©ºäº†ï¼Œäºæ˜¯è§¦å‘ä¿¡å· spider_idleï¼Œspideræ”¶åˆ°è¿™ä¸ªä¿¡å·ä¹‹åï¼Œç›´æ¥è¿æ¥ redis è¯»å– strart_urlæ± ï¼Œæ‹¿å»æ–°çš„ä¸€æ‰¹ urlï¼Œè¿”å›æ–°çš„ make_requests_from_url(url) ç»™å¼•æ“ï¼Œè¿›è€Œäº¤ç»™è°ƒåº¦å™¨è°ƒåº¦ã€‚</p>
<p>ç†Ÿæ‚‰äº†åŸç†å…¶å®å¯ä»¥è‡ªå·±æ¥å†™ schedulerï¼Œè‡ªå·±å®šä¹‰è°ƒåº¦ä¼˜å…ˆçº§å’Œé¡ºåºï¼ŒğŸ‘‡<br><img src="http://7xu83c.com1.z0.glb.clouddn.com/scheduler.png" alt=""></p>
<h2 id="Redis-é…ç½®"><a href="#Redis-é…ç½®" class="headerlink" title="Redis é…ç½®"></a>Redis é…ç½®</h2><h3 id="ä¸‹è½½-Redis"><a href="#ä¸‹è½½-Redis" class="headerlink" title="ä¸‹è½½ Redis"></a>ä¸‹è½½ Redis</h3><pre>wget http://download.redis.io/releases/redis-3.2.1.tar.gz</pre>

<h3 id="ä¸‹è½½-scrapy-redis"><a href="#ä¸‹è½½-scrapy-redis" class="headerlink" title="ä¸‹è½½ scrapy-redis"></a>ä¸‹è½½ scrapy-redis</h3><pre>pip install scrapy-redis</pre>

<h3 id="å®‰è£…-Redis"><a href="#å®‰è£…-Redis" class="headerlink" title="å®‰è£… Redis"></a>å®‰è£… Redis</h3><pre>make
make test</pre>

<h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><p>å®‰è£…å®Œæˆåï¼Œredis é»˜è®¤æ˜¯ä¸èƒ½è¢«è¿œç¨‹è¿æ¥çš„ï¼Œæ­¤æ—¶è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ redis.confï¼Œä¿®æ”¹åï¼Œé‡å¯ redis æœåŠ¡å™¨</p>
<pre>
#bind 127.0.0.1
bind 0.0.0.0
</pre>

<h3 id="ä»»æ„ç›®å½•ä¸‹è¿è¡Œ"><a href="#ä»»æ„ç›®å½•ä¸‹è¿è¡Œ" class="headerlink" title="ä»»æ„ç›®å½•ä¸‹è¿è¡Œ"></a>ä»»æ„ç›®å½•ä¸‹è¿è¡Œ</h3><pre>sudo cp redis.conf /etc/</pre>

<h3 id="å¯èƒ½é”™è¯¯"><a href="#å¯èƒ½é”™è¯¯" class="headerlink" title="å¯èƒ½é”™è¯¯"></a>å¯èƒ½é”™è¯¯</h3><p>å¦‚æœå› ä¸º gcc è€Œä¸èƒ½ make</p>
<pre>sudo apt-get build-dep gcc</pre>

<p>å¦‚æœé‡åˆ°è¿™ä¸ªï¼Œ</p>
<pre>make[1]: Entering directory `/opt/redis-2.6.14/src'
CC adlist.o
In file included from adlist.c:34:
zmalloc.h:50:31: error: jemalloc/jemalloc.h: No such file or directory
zmalloc.h:55:2: error: #error "Newer version of jemalloc required"
make[1]: *** [adlist.o] Error 1
make[1]: Leaving directory `/opt/redis-2.6.14/src'
make: *** [all] Error 2</pre>

<p>å¯ä»¥çœ‹<a href="http://blog.jboy1009.com/archives/150" target="_blank" rel="external">è¿™é‡Œ</a></p>
<p>ç”¨è¿™ä¸ªå‘½ä»¤</p>
<pre>make MALLOC=libc</pre>

<p>å¦‚æœé‡åˆ°è¿™ä¸ª</p>
<pre>You need tcl 8.5 or newer in order to run the Redis test</pre>

<p>å®‰è£… tcl</p>
<pre>sudo apt-get install tcl</pre>

<p>(redis æ›´å¤šå®‰è£…é…ç½®)[<a href="https://testerhome.com/topics/3887" target="_blank" rel="external">https://testerhome.com/topics/3887</a>]</p>
<h2 id="Redis-å¸¸ç”¨å‘½ä»¤"><a href="#Redis-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="Redis å¸¸ç”¨å‘½ä»¤"></a>Redis å¸¸ç”¨å‘½ä»¤</h2><h3 id="è¿è¡Œ-Redis"><a href="#è¿è¡Œ-Redis" class="headerlink" title="è¿è¡Œ Redis"></a>è¿è¡Œ Redis</h3><pre>redis-server redis.conf</pre>

<h3 id="è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼"><a href="#è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼" class="headerlink" title="è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼"></a>è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼</h3><pre>redis-cli</pre>

<h3 id="æ¸…ç©ºç¼“å­˜"><a href="#æ¸…ç©ºç¼“å­˜" class="headerlink" title="æ¸…ç©ºç¼“å­˜"></a>æ¸…ç©ºç¼“å­˜</h3><pre>flushdb</pre>

<h3 id="æŸ¥çœ‹æ‰€æœ‰-key"><a href="#æŸ¥çœ‹æ‰€æœ‰-key" class="headerlink" title="æŸ¥çœ‹æ‰€æœ‰ key"></a>æŸ¥çœ‹æ‰€æœ‰ key</h3><pre>
127.0.0.1:6379> keys *
1) "dmoz:items"
2) "dmoz:requests"
3) "dmoz:dupefilter"
</pre>

<h3 id="æŸ¥çœ‹-list-item"><a href="#æŸ¥çœ‹-list-item" class="headerlink" title="æŸ¥çœ‹ list (item)"></a>æŸ¥çœ‹ list (item)</h3><pre>
127.0.0.1:6379> LRANGE dmoz:items 0 3
1) "{\"spider\": \"dmoz\", \"crawled\": \"2016-07-12 11:18:35\", \"link\": \"http://feeds.abcnews.com/abcnews/topstories\", \"name\": \"ABC News: Top Stories \", \"description\": \"Collection of news headlines.\"}"
2) "{\"spider\": \"dmoz\", \"crawled\": \"2016-07-12 11:18:35\", \"link\": \"http://abcnews.go.com/\", \"name\": \"ABCNews.com \", \"description\": \"Includes American and world news headlines, articles, chatrooms, message boards, news alerts, video and audio webcasts, shopping, and wireless news service. As well as ABC television show information and content.\"}"
3) "{\"spider\": \"dmoz\", \"crawled\": \"2016-07-12 11:18:35\", \"link\": \"http://www.alarabiya.net/\", \"name\": \"Al Arabiya News Channel \", \"description\": \"Arabic-language news network. Breaking news and features along with videos, photo galleries and In-Focus sections on major news topics.  (Arabic, English, Persian, Urdu)\"}"
4) "{\"spider\": \"dmoz\", \"crawled\": \"2016-07-12 11:18:35\", \"link\": \"http://www.aljazeera.com/\", \"name\": \"Aljazeera \", \"description\": \"English version of the Arabic-language news network. Breaking news and features plus background material including profiles and global reactions.\"}"
</pre>

<h3 id="æŸ¥çœ‹-set-dupefilter"><a href="#æŸ¥çœ‹-set-dupefilter" class="headerlink" title="æŸ¥çœ‹ set (dupefilter)"></a>æŸ¥çœ‹ set (dupefilter)</h3><pre>
127.0.0.1:6379> SMEMBERS dmoz:dupefilter
   1) "28bf6cfa1409d6d2ad2852663a3751ae077a0b01"
   2) "6af16713d5d423a2e91c87085f277a810c690cfa"
   3) "c0ccfd767892b2bbb533a52c7cde55543aa4605b"
   4) "0ca88e614179c791f258d89a820449c91940c4d4"
   5) "546577e3457c55057c56985b71e6a142fe5a64e9"
   6) "d2af0f8cf72e394dc46a720ee620fd7cdb0b6ad6"
   7) "e0c1ab903b2a95f05bc8f5a5036b2f6f0b3fcbd0"
   8) "bf1290602aa0fd2deb7f8b582f855535ca151990"
   9) "c59f100b08e424352e6e368ff94d797c35fc5a4b"
  10) "5acf897c445b3dbba5b371f811b74e26c52cd5c6"
  </pre>


<h3 id="æŸ¥çœ‹-sorted-set-requests"><a href="#æŸ¥çœ‹-sorted-set-requests" class="headerlink" title="æŸ¥çœ‹ sorted set (requests)"></a>æŸ¥çœ‹ sorted set (requests)</h3><pre>
127.0.0.1:6379> ZRANGE dmoz:requests 0 3
1) "\x80\x02}q\x01(U\x04bodyq\x02U\x00U\t_encodingq\x03U\x05utf-8q\x04U\acookiesq\x05}q\x06U\x04metaq\a}q\b(U\x05depthq\tK\x01U\tlink_textq\nclxml.etree\n_ElementStringResult\nq\x0bU\tInvestingq\x0c\x85\x81q\r}q\x0e(U\a_parentq\x0fNU\x0cis_attributeq\x10\x89U\battrnameq\x11NU\ais_textq\x12\x89U\ais_tailq\x13\x89ubU\x04ruleq\x14K\x00uU\aheadersq\x15}q\x16U\aRefererq\x17]q\x18U\x14http://www.dmoz.org/q\x19asU\x03urlq\x1aX'\x00\x00\x00http://www.dmoz.org/Business/Investing/U\x0bdont_filterq\x1b\x89U\bpriorityq\x1cK\x00U\bcallbackq\x1dU\x14_response_downloadedq\x1eU\x06methodq\x1fU\x03GETq U\aerrbackq!Nu."
2) "\x80\x02}q\x01(U\x04bodyq\x02U\x00U\t_encodingq\x03U\x05utf-8q\x04U\acookiesq\x05}q\x06U\x04metaq\a}q\b(U\x05depthq\tK\x01U\tlink_textq\nclxml.etree\n_ElementStringResult\nq\x0bU\tLibrariesq\x0c\x85\x81q\r}q\x0e(U\a_parentq\x0fNU\x0cis_attributeq\x10\x89U\battrnameq\x11NU\ais_textq\x12\x89U\ais_tailq\x13\x89ubU\x04ruleq\x14K\x00uU\aheadersq\x15}q\x16U\aRefererq\x17]q\x18U\x14http://www.dmoz.org/q\x19asU\x03urlq\x1aX(\x00\x00\x00http://www.dmoz.org/Reference/Libraries/U\x0bdont_filterq\x1b\x89U\bpriorityq\x1cK\x00U\bcallbackq\x1dU\x14_response_downloadedq\x1eU\x06methodq\x1fU\x03GETq U\aerrbackq!Nu."
3) "\x80\x02}q\x01(U\x04bodyq\x02U\x00U\t_encodingq\x03U\x05utf-8q\x04U\acookiesq\x05}q\x06U\x04metaq\a}q\b(U\x05depthq\tK\x01U\tlink_textq\nclxml.etree\n_ElementStringResult\nq\x0bU\tTeen Lifeq\x0c\x85\x81q\r}q\x0e(U\a_parentq\x0fNU\x0cis_attributeq\x10\x89U\battrnameq\x11NU\ais_textq\x12\x89U\ais_tailq\x13\x89ubU\x04ruleq\x14K\x00uU\aheadersq\x15}q\x16U\aRefererq\x17]q\x18U\x14http://www.dmoz.org/q\x19asU\x03urlq\x1aX-\x00\x00\x00http://www.dmoz.org/Kids_and_Teens/Teen_Life/U\x0bdont_filterq\x1b\x89U\bpriorityq\x1cK\x00U\bcallbackq\x1dU\x14_response_downloadedq\x1eU\x06methodq\x1fU\x03GETq U\aerrbackq!Nu."
4) "\x80\x02}q\x01(U\x04bodyq\x02U\x00U\t_encodingq\x03U\x05utf-8q\x04U\acookiesq\x05}q\x06U\x04metaq\a}q\b(U\x05depthq\tK\x01U\tlink_textq\nclxml.etree\n_ElementStringResult\nq\x0bU\nBasketballq\x0c\x85\x81q\r}q\x0e(U\a_parentq\x0fNU\x0cis_attributeq\x10\x89U\battrnameq\x11NU\ais_textq\x12\x89U\ais_tailq\x13\x89ubU\x04ruleq\x14K\x00uU\aheadersq\x15}q\x16U\aRefererq\x17]q\x18U\x14http://www.dmoz.org/q\x19asU\x03urlq\x1aX&\x00\x00\x00http://www.dmoz.org/Sports/Basketball/U\x0bdont_filterq\x1b\x89U\bpriorityq\x1cK\x00U\bcallbackq\x1dU\x14_response_downloadedq\x1eU\x06methodq\x1fU\x03GETq U\aerrbackq!Nu."
</pre>


<h3 id="æŸ¥çœ‹-list-items-é•¿åº¦"><a href="#æŸ¥çœ‹-list-items-é•¿åº¦" class="headerlink" title="æŸ¥çœ‹ list (items) é•¿åº¦"></a>æŸ¥çœ‹ list (items) é•¿åº¦</h3><p>127.0.0.1:6379&gt; LLEN Search:items<br>(integer) 376</p>
<h3 id="æŸ¥çœ‹-sorted-set-requests-é•¿åº¦"><a href="#æŸ¥çœ‹-sorted-set-requests-é•¿åº¦" class="headerlink" title="æŸ¥çœ‹ sorted set (requests) é•¿åº¦"></a>æŸ¥çœ‹ sorted set (requests) é•¿åº¦</h3><p>127.0.0.1:6379&gt; ZCARD Search:requests<br>(integer) 1</p>
<h3 id="æŸ¥çœ‹-set-dupefilter-é•¿åº¦"><a href="#æŸ¥çœ‹-set-dupefilter-é•¿åº¦" class="headerlink" title="æŸ¥çœ‹ set (dupefilter) é•¿åº¦"></a>æŸ¥çœ‹ set (dupefilter) é•¿åº¦</h3><p>127.0.0.1:6379&gt; SCARD Search:dupefilter<br>(integer) 1</p>
<p><a href="http://www.runoob.com/redis/redis-tutorial.html" target="_blank" rel="external">Redis æ•™ç¨‹</a></p>
<h2 id="scrapy-redis-é…ç½®"><a href="#scrapy-redis-é…ç½®" class="headerlink" title="scrapy_redis é…ç½®"></a>scrapy_redis é…ç½®</h2><p>ä» github ä¸Š ä¸‹è½½ <a href="https://github.com/rolando/scrapy-redis" target="_blank" rel="external">example</a>ï¼Œä¿®æ”¹ç›¸åº”æ–‡ä»¶ï¼Œitems.py, settings.py, process_items.py ç­‰ã€‚æœ€é‡è¦çš„æ˜¯æ”¹ settings.py</p>
<h3 id="é€šç”¨é…ç½®"><a href="#é€šç”¨é…ç½®" class="headerlink" title="é€šç”¨é…ç½®"></a>é€šç”¨é…ç½®</h3><pre>
SCHEDULER = "scrapy_redis.scheduler.Scheduler"
DUPEFILTER_CLASS = "scrapy_redis.dupefilter.RFPDupeFilter"
SCHEDULER_QUEUE_CLASS = "scrapy_redis.queue.SpiderPriorityQueue"
SCHEDULER_PERSIST = True

# ITEM_PIPELINES
ITEM_PIPELINES = {
    'scrapy_redis.pipelines.RedisPipeline': 400,
}
</pre>

<h3 id="master-é…ç½®"><a href="#master-é…ç½®" class="headerlink" title="master é…ç½®"></a>master é…ç½®</h3><p>settings.py ä¸­æ·»åŠ </p>
<pre>
# redis
REDIS_HOST = '127.0.0.1'
REDIS_PORT = 6379
</pre>

<h3 id="slave-é…ç½®"><a href="#slave-é…ç½®" class="headerlink" title="slave é…ç½®"></a>slave é…ç½®</h3><p>settings.py ä¸­æ·»åŠ </p>
<pre>
# redis
REDIS_URL = 'redis://host_ip:6379'
</pre>

<h3 id="spider-æ”¹å†™"><a href="#spider-æ”¹å†™" class="headerlink" title="spider æ”¹å†™"></a>spider æ”¹å†™</h3><p>å¯¼å…¥æ¨¡å—</p>
<pre>from scrapy_redis.spiders import RedisSpider</pre>

<p>ç»§æ‰¿ RedisSpiderï¼Œå¹¶ä» Redis è¯»å– url</p>
<pre>
class Search(RedisCrawlSpider):
    name = "Search"
    redis_key = 'Search:start_urls'</pre>

<h2 id="è¿è¡Œçˆ¬è™«"><a href="#è¿è¡Œçˆ¬è™«" class="headerlink" title="è¿è¡Œçˆ¬è™«"></a>è¿è¡Œçˆ¬è™«</h2><p>åœ¨ master ä¸Šå¯åŠ¨ Redis</p>
<pre>redis-server</pre>


<p>å¯åŠ¨ spiderï¼Œä»»æ„é¡ºåº</p>
<pre>scrapy crawl Search</pre>

<p>å¯ä»¥çœ‹åˆ° schedule äº†å¤šå°‘ request</p>
<pre>
$ scrapy crawl Search
... [Search] DEBUG: Resuming crawl (8712 requests scheduled)</pre>


<h2 id="å¯¼å‡ºæ•°æ®"><a href="#å¯¼å‡ºæ•°æ®" class="headerlink" title="å¯¼å‡ºæ•°æ®"></a>å¯¼å‡ºæ•°æ®</h2><p>å†™åˆ°æ•°æ®åº“é‡Œå¾ˆç®€å•ï¼Œåœ¨ process_items.py é‡Œæ·»åŠ ä»£ç ï¼ŒæŒ‡å®šæ•°æ®åº“ ipï¼Œæ’å…¥åŒä¸€ä¸ªæ•°æ®åº“ã€‚è¿™é‡Œæˆ‘ä»¬çš„æ•°æ®ä¸ç”¨å¯¼å‡ºåˆ° mongodb ç­‰æ•°æ®åº“ï¼Œåªç”¨æŠŠå®ƒè½¬åŒ–ä¸ºæ–‡æœ¬æ–‡ä»¶å³å¯ã€‚</p>
<h3 id="redis-dump"><a href="#redis-dump" class="headerlink" title="redis-dump"></a>redis-dump</h3><p>å®‰è£… redis-dump</p>
<pre>gem install redis-dump</pre>

<p>å¯¼å‡º</p>
<pre>redis-dump -u 127.0.0.1:6379 > db.json</pre>

<p>æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¯¼å‡ºçš„æ˜¯æ•°æ®åº“é‡Œæ‰€æœ‰çš„ key-valueï¼Œä¹Ÿå°±æ˜¯è¯´ä¹‹åå¤„ç† items çš„æ—¶å€™å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼Œitem list å¤ªå¤§è¯»å–é€ æˆ memory errorã€‚</p>
<h3 id="python-è¿æ¥-redis"><a href="#python-è¿æ¥-redis" class="headerlink" title="python è¿æ¥ redis"></a>python è¿æ¥ redis</h3><p>å¾ˆç®€å•ï¼Œå¯¼å…¥æ¨¡å—ï¼Œè¿æ¥æ•°æ®åº“ï¼Œå…¶ä»–åŸºæœ¬æŒ‰ç…§ redis å‘½ä»¤æ¥ã€‚</p>
<pre>import redis
r = redis.Redis(host='106.75.136.128', port=6379)</pre>

<p>å¦‚</p>
<pre>for i in range(0, r.llen('Search:items'), 100):
    items = r.lrange('Search:items', start=0, end=100)</pre>

<p>ç„¶åæŠŠæ–‡ä»¶å†™åˆ°æ–‡ä»¶é‡Œã€‚</p>
<h2 id="ç›‘æ§"><a href="#ç›‘æ§" class="headerlink" title="ç›‘æ§"></a>ç›‘æ§</h2><p>åˆ†å¸ƒå¼ç³»ç»Ÿè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆç›‘æ§ slaveï¼ŒçŸ¥é“å“ªå°æœºå™¨åäº†ï¼Œå¯ä»¥å†™ä¸ª socket å‘ master æŠ¥å‘Šï¼Œæˆ–è€…ç”¨ email å‘Šè­¦ã€‚</p>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>æ¯æ¬¡æ‰§è¡Œé‡æ–°çˆ¬å–ï¼Œåº”è¯¥å°†redisä¸­å­˜å‚¨çš„æ•°æ®æ¸…ç©ºï¼Œå¦åˆ™å½±å“çˆ¬å–ç°è±¡ã€‚</p>
<p>å¦å¤–ï¼Œrequest å’Œ url æ˜¯ä¸åŒçš„ï¼Œå‰è€…æ˜¯ç”±åè€…ç»ç”±å‡½æ•°make_request_from_urlå®ç°ï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹ç”±spiderå®Œæˆã€‚spiderä¼šè¿”å›ï¼ˆreturnã€yieldï¼‰requestç»™scrapyå¼•æ“è¿›è€Œäº¤å‰²è°ƒåº¦å™¨ã€‚urlä¹Ÿæ˜¯åœ¨spiderä¸­å®šä¹‰æˆ–ç”±spiderè·å–çš„ã€‚</p>
<blockquote>
<p>å‚è€ƒé“¾æ¥:<br><a href="https://www.douban.com/group/topic/38361104/" target="_blank" rel="external">ä½¿ç”¨scrapy,redis,mongodbå®ç°çš„ä¸€ä¸ªåˆ†å¸ƒå¼ç½‘ç»œçˆ¬è™«</a><br><a href="http://blog.csdn.net/u012150179/article/details/38091411" target="_blank" rel="external">scrapy-rediså®ç°çˆ¬è™«åˆ†å¸ƒå¼çˆ¬å–åˆ†æä¸å®ç°</a><br><a href="http://www.jikexueyuan.com/course/1556.html" target="_blank" rel="external">å®šå‘çˆ¬è™«ï¼šScrapy ä¸ Redis å…¥é—¨</a><br><a href="http://www.pycoding.com/2016/03/19/scrapy-07.html" target="_blank" rel="external">Scrapyç¬”è®°ï¼ˆ7ï¼‰- å†…ç½®æœåŠ¡</a><br><a href="http://www.codexiu.cn/python/blog/6109/" target="_blank" rel="external">åŸºäºRedisçš„ä¸‰ç§åˆ†å¸ƒå¼çˆ¬è™«ç­–ç•¥</a><br><a href="http://ju.outofmemory.cn/entry/206756" target="_blank" rel="external">åŸºäºPython,scrapy,redisçš„åˆ†å¸ƒå¼çˆ¬è™«å®ç°æ¡†æ¶</a><br><a href="http://blog.csdn.net/u012150179/article/details/38226253" target="_blank" rel="external">scrapy-redisæºç åˆ†æ</a><br><a href="http://www.lxway.net/550248426.html" target="_blank" rel="external">Scrapy Redisæºç  spideråˆ†æ</a></p>
</blockquote>

      
    </div>

    <div>
      
        
<div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat.jpg" alt="å¾é˜¿è¡¡ wechat" style="width: 200px; max-width: 100%;"/>
    <div>æ¬¢è¿å…³æ³¨ï¼šå¾é˜¿è¡¡çš„å¾®ä¿¡å…¬ä¼—å·</div>
</div>


      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>å®¢å®˜ï¼Œæ‰“ä¸ªèµå‘—~</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>èµ</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://7xu83c.com1.z0.glb.clouddn.com/1.pic.jpg" alt="å¾é˜¿è¡¡ WeChat Pay"/>
          <p>å¾®ä¿¡æ‰“èµ</p>
        </div>
      
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Crawler/" rel="tag">#Crawler</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/06/15/è®²åº§ç¬”è®° -- è…¾è®¯åº”ç”¨å®/" rel="next" title="è®²åº§ç¬”è®° -- è…¾è®¯åº”ç”¨å®">
                <i class="fa fa-chevron-left"></i> è®²åº§ç¬”è®° -- è…¾è®¯åº”ç”¨å®
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/06/20/çˆ¬è™«æ€»ç»“-äº”-å…¶ä»–æŠ€å·§/" rel="prev" title="çˆ¬è™«æ€»ç»“(äº”)-- å…¶ä»–æŠ€å·§">
                çˆ¬è™«æ€»ç»“(äº”)-- å…¶ä»–æŠ€å·§ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      



    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
     
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://7xu83c.com1.z0.glb.clouddn.com/2.pic.jpg"
               alt="å¾é˜¿è¡¡" />
          <p class="site-author-name" itemprop="name">å¾é˜¿è¡¡</p>
          <p class="site-description motion-element" itemprop="description">è¯»ä¸‡å·ä¹¦ï¼Œè¡Œä¸‡é‡Œè·¯ @SYSU @CMU</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">160</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">123</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Shuang0420" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.linkedin.com/in/shuang-xu-7008b894?trk=nav_responsive_tab_profile_pic" target="_blank" title="LinkedIn">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  LinkedIn
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://zhuanlan.zhihu.com/c_136690664" target="_blank" title="çŸ¥ä¹">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  çŸ¥ä¹
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://starllap.space" title="Star" target="_blank">Star</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://liam0205.me" title="Liam Huang" target="_blank">Liam Huang</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.libinx.com" title="Li Bin" target="_blank">Li Bin</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Scrapyd"><span class="nav-number">1.</span> <span class="nav-text">Scrapyd</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crawlera"><span class="nav-number">2.</span> <span class="nav-text">Crawlera</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Scrapy-redis"><span class="nav-number">3.</span> <span class="nav-text">Scrapy-redis</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ†å¸ƒå¼åŸç†"><span class="nav-number">3.1.</span> <span class="nav-text">åˆ†å¸ƒå¼åŸç†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æºç åˆ†æ"><span class="nav-number">3.2.</span> <span class="nav-text">æºç åˆ†æ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é›¶ä»¶åˆ†æ"><span class="nav-number">3.2.1.</span> <span class="nav-text">é›¶ä»¶åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è°ƒåº¦è¿‡ç¨‹"><span class="nav-number">3.2.2.</span> <span class="nav-text">è°ƒåº¦è¿‡ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆå§‹åŒ–"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">åˆå§‹åŒ–</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆ¤é‡-amp-è¿›å…¥è°ƒåº¦æ± "><span class="nav-number">3.2.2.2.</span> <span class="nav-text">åˆ¤é‡ & è¿›å…¥è°ƒåº¦æ± </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è°ƒåº¦"><span class="nav-number">3.2.2.3.</span> <span class="nav-text">è°ƒåº¦</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-é…ç½®"><span class="nav-number">3.3.</span> <span class="nav-text">Redis é…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸‹è½½-Redis"><span class="nav-number">3.3.1.</span> <span class="nav-text">ä¸‹è½½ Redis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸‹è½½-scrapy-redis"><span class="nav-number">3.3.2.</span> <span class="nav-text">ä¸‹è½½ scrapy-redis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…-Redis"><span class="nav-number">3.3.3.</span> <span class="nav-text">å®‰è£… Redis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¿®æ”¹é…ç½®æ–‡ä»¶"><span class="nav-number">3.3.4.</span> <span class="nav-text">ä¿®æ”¹é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»»æ„ç›®å½•ä¸‹è¿è¡Œ"><span class="nav-number">3.3.5.</span> <span class="nav-text">ä»»æ„ç›®å½•ä¸‹è¿è¡Œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯èƒ½é”™è¯¯"><span class="nav-number">3.3.6.</span> <span class="nav-text">å¯èƒ½é”™è¯¯</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-å¸¸ç”¨å‘½ä»¤"><span class="nav-number">3.4.</span> <span class="nav-text">Redis å¸¸ç”¨å‘½ä»¤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿è¡Œ-Redis"><span class="nav-number">3.4.1.</span> <span class="nav-text">è¿è¡Œ Redis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼"><span class="nav-number">3.4.2.</span> <span class="nav-text">è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¸…ç©ºç¼“å­˜"><span class="nav-number">3.4.3.</span> <span class="nav-text">æ¸…ç©ºç¼“å­˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹æ‰€æœ‰-key"><span class="nav-number">3.4.4.</span> <span class="nav-text">æŸ¥çœ‹æ‰€æœ‰ key</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹-list-item"><span class="nav-number">3.4.5.</span> <span class="nav-text">æŸ¥çœ‹ list (item)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹-set-dupefilter"><span class="nav-number">3.4.6.</span> <span class="nav-text">æŸ¥çœ‹ set (dupefilter)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹-sorted-set-requests"><span class="nav-number">3.4.7.</span> <span class="nav-text">æŸ¥çœ‹ sorted set (requests)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹-list-items-é•¿åº¦"><span class="nav-number">3.4.8.</span> <span class="nav-text">æŸ¥çœ‹ list (items) é•¿åº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹-sorted-set-requests-é•¿åº¦"><span class="nav-number">3.4.9.</span> <span class="nav-text">æŸ¥çœ‹ sorted set (requests) é•¿åº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹-set-dupefilter-é•¿åº¦"><span class="nav-number">3.4.10.</span> <span class="nav-text">æŸ¥çœ‹ set (dupefilter) é•¿åº¦</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#scrapy-redis-é…ç½®"><span class="nav-number">3.5.</span> <span class="nav-text">scrapy_redis é…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é€šç”¨é…ç½®"><span class="nav-number">3.5.1.</span> <span class="nav-text">é€šç”¨é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#master-é…ç½®"><span class="nav-number">3.5.2.</span> <span class="nav-text">master é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#slave-é…ç½®"><span class="nav-number">3.5.3.</span> <span class="nav-text">slave é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#spider-æ”¹å†™"><span class="nav-number">3.5.4.</span> <span class="nav-text">spider æ”¹å†™</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è¿è¡Œçˆ¬è™«"><span class="nav-number">3.6.</span> <span class="nav-text">è¿è¡Œçˆ¬è™«</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¯¼å‡ºæ•°æ®"><span class="nav-number">3.7.</span> <span class="nav-text">å¯¼å‡ºæ•°æ®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#redis-dump"><span class="nav-number">3.7.1.</span> <span class="nav-text">redis-dump</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#python-è¿æ¥-redis"><span class="nav-number">3.7.2.</span> <span class="nav-text">python è¿æ¥ redis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç›‘æ§"><span class="nav-number">3.8.</span> <span class="nav-text">ç›‘æ§</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å…¶ä»–"><span class="nav-number">3.9.</span> <span class="nav-text">å…¶ä»–</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <!-- Other code may be here -->
<div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å¾é˜¿è¡¡</span>
  <a href="http://www.miitbeian.gov.cn/">ç²¤ICPå¤‡17129486å·</a>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>


<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'httpshuang0420githubio';
      var disqus_identifier = '2016/06/17/çˆ¬è™«æ€»ç»“-å››-åˆ†å¸ƒå¼çˆ¬è™«/';
      var disqus_title = "çˆ¬è™«æ€»ç»“(å››)-- åˆ†å¸ƒå¼çˆ¬è™«";
      var disqus_url = 'http://www.shuang0420.com/2016/06/17/çˆ¬è™«æ€»ç»“-å››-åˆ†å¸ƒå¼çˆ¬è™«/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>
</html>
